<!doctype html><html lang="zh-Hant"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="assets/favicon.png" type="image/png"><title>é˜¿è¬èˆ‡å‹•ç‰©æœ‹å‹æŒ‰éˆ•</title><style>:root{--bg:#0b0d10;--search:#0b0d1000;--fg:#e9eef5;--muted:#a8b3c7;--card:#141821;--card-2:#212832;--border:#202636;--accent:#6aa9ff;--accent-2:#ff9e6a;--heart:#ff5a7a;--chip-fg:#0b0d10;--hover-overlay:rgba(96, 150, 255, 0.20);--glass-bg:rgba(20, 24, 33, 0.8);--glass-border:rgba(255, 255, 255, 0.12);--bg-blend-mode:normal;--bg-opacity:0.25;--space-xs:4px;--space-sm:8px;--space-md:12px;--space-lg:16px;--space-xl:20px;--space-2xl:24px;--radius-sm:8px;--radius-md:10px;--radius-lg:12px;--radius-xl:16px;--radius-pill:999px;--shadow-sm:0 2px 6px rgba(0, 0, 0, 0.18);--shadow-md:0 6px 24px rgba(0, 0, 0, 0.25);--shadow-lg:0 8px 24px rgba(0, 0, 0, 0.35);--shadow:var(--shadow-md);--duration-fast:0.06s;--duration-normal:0.15s;--duration-slow:0.3s;--control-h:44px}:root.light{--bg:#f8fafc;--search:#f8fafc00;--fg:#0d1320;--muted:#4b5563;--card:#ffffff;--card-2:#f3f6fb;--border:#e5e7eb;--accent:#2563eb;--accent-2:#eb7b25;--heart:#e11d48;--chip-fg:#ffffff;--glass-bg:rgba(255, 255, 255, 0.6);--glass-border:rgba(15, 23, 42, 0.12);--bg-blend-mode:normal;--bg-opacity:0.35;--shadow-sm:0 2px 6px rgba(2, 6, 23, 0.06);--shadow-md:0 4px 18px rgba(2, 6, 23, 0.08);--shadow-lg:0 6px 24px rgba(2, 6, 23, 0.12);--shadow:var(--shadow-md)}*,::after,::before{box-sizing:border-box}body,html{height:100%}body{margin:0;background-color:var(--bg);color:var(--fg);font:medium ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Noto Sans,"Helvetica Neue",Arial;position:relative;z-index:1}::-webkit-scrollbar{width:14px;height:14px}::-webkit-scrollbar-track{background:0 0}::-webkit-scrollbar-thumb{background:var(--muted);border-radius:var(--radius-pill);border:3px solid var(--bg)}::-webkit-scrollbar-thumb:hover{background:var(--accent);border-width:2px}::-webkit-scrollbar-corner{background:0 0}body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background-image:url('assets/background-by-jia.avif');background-size:auto 90%;background-repeat:repeat;background-attachment:fixed;background-position:var(--bg-x,0) 0;transition:background-position 1s ease-out;mix-blend-mode:var(--bg-blend-mode);opacity:var(--bg-opacity);z-index:-1;pointer-events:none}a{color:inherit}#page-about .about-content,.bg-credit,.cg-board,.cg-header,.cg-result,.cg-rules,.menu,.searchbar,.sound{background:var(--glass-bg);border:1px solid var(--glass-border);backdrop-filter:saturate(1.8) blur(12px);-webkit-backdrop-filter:saturate(1.8) blur(12px);box-shadow:var(--shadow)}.btn{display:inline-flex;align-items:center;justify-content:center;gap:var(--space-xs);padding:var(--space-sm) var(--space-md);border:1px solid var(--border);border-radius:var(--radius-md);background:linear-gradient(to bottom,var(--card),var(--card-2));color:var(--fg);font-size:14px;font-weight:500;cursor:pointer;transition:all var(--duration-normal) ease;box-shadow:var(--shadow-sm)}.btn:hover{background:linear-gradient(to bottom,var(--card-2),var(--border));border-color:var(--accent);transform:translateY(-1px);box-shadow:var(--shadow-md)}.btn:active{transform:translateY(0);box-shadow:var(--shadow-sm)}.btn--small,.small-btn{padding:var(--space-xs) var(--space-sm);font-size:12px;border-radius:var(--radius-sm)}.btn--icon{min-width:32px;padding:6px}.chip{display:inline-flex;align-items:center;gap:var(--space-xs);padding:var(--space-xs) var(--space-sm);border-radius:var(--radius-pill);font-size:12px;color:var(--chip-fg);box-shadow:var(--shadow-sm);cursor:pointer}.chip button{appearance:none;border:0;background:0 0;color:inherit;cursor:pointer;font-size:14px;line-height:1;padding:0 0 0 2px}.chips{display:flex;flex-wrap:wrap;gap:var(--space-xs);margin-top:var(--space-xs)}.tag{display:inline-block;padding:3px 6px;border-radius:var(--radius-pill);font-size:small;color:var(--chip-fg);white-space:nowrap;cursor:pointer;box-shadow:var(--shadow-sm)}.tags{display:flex;flex-wrap:wrap;gap:6px}.tag-list{display:flex;flex-wrap:wrap;gap:6px var(--space-sm);margin:var(--space-sm) 0}.grid{display:grid;gap:var(--space-xs);grid-template-columns:repeat(6,minmax(0,1fr))}.wrap{max-width:1100px;margin:0 auto;padding:var(--space-xl)}header{display:flex;align-items:center;flex-wrap:nowrap;gap:var(--space-md);margin-bottom:14px}header h1{white-space:normal;min-width:0;overflow-wrap:anywhere;margin-right:auto}h1{font-size:1.4rem;margin:0 var(--space-sm) 0 0;letter-spacing:.5px}.theme-toggle{border:1px solid var(--border);background:var(--card);color:var(--fg);border-radius:var(--radius-md);padding:var(--space-sm) var(--space-md);cursor:pointer;box-shadow:var(--shadow)}.tabs{display:flex;gap:var(--space-sm);align-items:center;flex-wrap:wrap}.tab{display:inline-block;padding:6px var(--space-lg);font-size:14px;border:1px solid var(--border);border-radius:var(--radius-pill);background:var(--card-2);color:var(--fg);cursor:pointer;transition:background var(--duration-normal) ease,color var(--duration-normal) ease}.tab:hover{background:var(--card)}.tab.active{background:var(--accent);border-color:var(--accent);color:var(--chip-fg)}.nav-toggle{display:none;align-items:center;justify-content:center;border:1px solid var(--border);background:var(--card);color:var(--fg);border-radius:var(--radius-md);padding:var(--space-sm);cursor:pointer;box-shadow:var(--shadow)}.section-header{display:flex;align-items:center;justify-content:space-between;margin:14px 0 var(--space-sm)}.section-header h3{margin:0;font-size:1rem;font-weight:600;letter-spacing:.2px}.section-header .actions{display:flex;gap:3px}.section-title{margin:18px 0 10px;font-weight:700;letter-spacing:.3px}.anniversary-zone{width:100%;margin-bottom:var(--space-sm);border-radius:var(--radius-md);box-shadow:var(--shadow-md);position:relative;overflow:hidden;min-height:60px;display:flex;align-items:center;justify-content:center}.anniversary-content{width:100%;height:100%;padding:var(--space-md);display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:transform var(--duration-fast);z-index:1}.anniversary-content:active{transform:scale(.98)}.anniversary-text{color:#fff;font-weight:900;font-size:1.5rem;text-shadow:0 2px 4px rgba(0,0,0,.5);user-select:none;letter-spacing:1px}.search-row{display:flex;flex-wrap:nowrap;gap:0;align-items:stretch;position:sticky;top:0;background:var(--search);padding:var(--space-sm) 0 var(--space-md);z-index:5}.searchbar{flex:1 1 auto;min-width:0;display:flex;align-items:center;gap:6px;border-radius:var(--radius-lg) 0 0 var(--radius-lg);border-right:0;padding:6px var(--space-sm);position:relative;height:var(--control-h);transition:box-shadow var(--duration-normal) ease,border-color var(--duration-normal) ease}.searchbar:focus-within{border-color:var(--accent);box-shadow:0 0 0 3px rgba(106,169,255,.25);z-index:1}.searchbar input{flex:1;min-width:0;background:0 0;border:0;outline:0;color:var(--fg);font-size:16px;height:100%;line-height:var(--control-h);padding:0 6px}.search-row #clearBtn{flex:0 0 auto;white-space:nowrap;border-top-left-radius:0;border-bottom-left-radius:0;border-left:1px solid var(--glass-border);background:var(--glass-bg);backdrop-filter:saturate(1.5) blur(8px);-webkit-backdrop-filter:saturate(1.5) blur(8px);height:var(--control-h);display:inline-flex;align-items:center;justify-content:center;padding:0 14px;box-shadow:none;transition:color var(--duration-normal) ease}.search-row #clearBtn:hover{background:var(--glass-bg);border-top-color:var(--border);border-right-color:var(--border);border-bottom-color:var(--border);border-left-color:var(--glass-border);transform:none;box-shadow:none;color:var(--accent)}.search-row #clearBtn:active{transform:none;box-shadow:none}.sound{border-radius:var(--radius-lg);padding:var(--space-sm);display:flex;flex-direction:column;gap:5px 2px;user-select:none;cursor:pointer;transition:transform var(--duration-normal) cubic-bezier(.34, 1.56, .64, 1),box-shadow var(--duration-normal) ease,border-color var(--duration-normal) ease}.sound:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg);border-color:var(--accent);z-index:10}.sound:active{transform:scale(.98);transition:transform var(--duration-fast) ease}.sound-top{display:flex;align-items:center;gap:var(--space-xs)}.title{font-weight:600;font-size:smaller;flex:1;min-width:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.heart{width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;border:1px solid var(--border);background:var(--card-2);cursor:pointer;flex:0 0 auto;padding:0}.heart svg{width:14px;height:14px;display:block;flex-shrink:0}.heart[aria-pressed=true] svg path{fill:var(--heart)}.stage{position:fixed;left:0;right:0;bottom:var(--space-md);display:flex;flex-wrap:wrap;gap:var(--space-md) 14px;justify-content:center;pointer-events:none;z-index:40;padding:0 var(--space-md)}.group{display:inline-flex;gap:var(--space-sm);align-items:flex-end}.avatar{width:75px;height:75px;border-radius:var(--radius-pill);background:0 0;overflow:hidden;border:2px solid rgba(255,255,255,.8);box-shadow:var(--shadow-lg);transform-origin:50% 100%}.avatar>img{width:100%;height:100%;object-fit:cover}.menu{position:fixed;z-index:9999;min-width:180px;border-radius:var(--radius-lg);overflow:hidden}.menu.hidden{display:none}.menu-item{padding:10px var(--space-md);cursor:pointer;border-bottom:1px solid var(--border);transition:background var(--duration-normal) ease}.menu-item:last-child{border-bottom:0}.menu-item:hover{background:var(--hover-overlay)}.toast{position:fixed;left:50%;bottom:80px;transform:translateX(-50%);background:var(--card);border:1px solid var(--border);padding:10px 14px;border-radius:var(--radius-md);box-shadow:var(--shadow);z-index:70}.toast.hidden{display:none}.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.45);display:flex;align-items:center;justify-content:center;z-index:120}.modal-backdrop.hidden{display:none}.modal{background:var(--bg);border:1px solid var(--glass-border);border-radius:var(--radius-lg);padding:var(--space-md);max-width:320px;box-shadow:var(--shadow)}.modal-actions{display:flex;justify-content:flex-end;gap:10px;margin-top:var(--space-lg)}.gradient-r1-background{background:linear-gradient(180deg,#ffc0ab,#ff893d,#ffde82,#b2f4c7,#60cfff,#2d7eff,#b5b1ff);background-size:1400% 1400%;-webkit-animation:gradient-key-r1 30s ease infinite;-moz-animation:gradient-key-r1 30s ease infinite;animation:gradient-key-r1 30s ease infinite}@-webkit-keyframes gradient-key-r1{0%{background-position:50% 0}50%{background-position:50% 100%}100%{background-position:50% 0}}@-moz-keyframes gradient-key-r1{0%{background-position:50% 0}50%{background-position:50% 100%}100%{background-position:50% 0}}@keyframes gradient-key-r1{0%{background-position:50% 0}50%{background-position:50% 100%}100%{background-position:50% 0}}#page-about .about-content{border-radius:14px;padding:14px var(--space-lg)}.bg-credit{position:fixed;right:var(--space-lg);bottom:var(--space-lg);font-size:large;padding:var(--space-sm) var(--space-md);border-radius:var(--radius-md);font-weight:800;z-index:60}.bg-credit a{text-decoration:underline}body.bg-full{--bg-opacity:1!important}@keyframes popIn{0%{transform:translateY(20px) scale(.7);opacity:0}100%{transform:translateY(0) scale(1);opacity:1}}@keyframes jitter{0%,100%{transform:translateY(0) rotate(0)}20%{transform:translateY(-2px) rotate(-1deg)}40%{transform:translateY(1px) rotate(1deg)}60%{transform:translateY(-1px) rotate(.6deg)}80%{transform:translateY(1px) rotate(-.6deg)}}@keyframes hopOut{0%{transform:translateY(0);opacity:1}22%{transform:translateY(-12px);opacity:1}100%{transform:translateY(60px);opacity:0}}.pop-in{animation:popIn .28s cubic-bezier(.2,.9,.18,1) both}.jit{animation:jitter .9s ease-in-out infinite}.hop-out{animation:hopOut .5s cubic-bezier(.2,.8,.2,1) forwards}@media (max-width:1000px){.grid{grid-template-columns:repeat(5,minmax(0,1fr))}}@media (max-width:800px){.grid{grid-template-columns:repeat(4,minmax(0,1fr))}}@media (max-width:760px){.nav-toggle{display:inline-flex}header .tabs{display:none;position:absolute;right:0;top:100%;padding:var(--space-sm);border-radius:var(--radius-lg);gap:6px;flex-direction:column;align-items:stretch;min-width:180px;z-index:120;background:var(--glass-bg);border:1px solid var(--glass-border);backdrop-filter:saturate(1.8) blur(12px);-webkit-backdrop-filter:saturate(1.8) blur(12px);box-shadow:var(--shadow)}body.nav-open header .tabs{display:flex}}@media (max-width:600px){.grid{grid-template-columns:repeat(3,minmax(0,1fr))}header .tabs{margin-top:var(--space-sm)}header .theme-toggle{margin-top:var(--space-sm)}}@media (max-width:400px){.grid{grid-template-columns:repeat(2,minmax(0,1fr))}}.hidden{display:none}.no-transition,.no-transition *{transition:none!important}.desc{color:var(--muted);font-size:14px;margin:0 0 6px}.empty{color:var(--muted);padding:var(--space-md) 0}.glow-persistent{box-shadow:0 0 0 4px rgba(106,169,255,.5),0 0 12px rgba(106,169,255,.75);transition:box-shadow var(--duration-slow) ease}.drag-ghost{opacity:.6;transform:scale(.98)}.drag-chosen{outline:2px dashed var(--accent)}.dragging{cursor:grabbing}body.sorting #favGrid .card{cursor:grab}header{position:relative}.cg-board{display:grid;grid-template-columns:repeat(4,70px);grid-template-rows:repeat(4,70px);gap:var(--space-sm);justify-content:center;margin:12px auto;width:min(720px,96%);padding:12px;border-radius:var(--radius-lg);justify-items:center}.cg-card{width:70px;height:70px;background:#888;border-radius:10px;display:flex;align-items:center;justify-content:center;cursor:pointer;position:relative;perspective:600px;will-change:transform;transition:transform var(--duration-normal) ease,box-shadow var(--duration-normal) ease;user-select:none}.cg-card.matched{opacity:.5;pointer-events:none}.cg-card-inner{width:100%;height:100%;transition:transform .4s cubic-bezier(.4, 2, .6, 1);transform-style:preserve-3d;position:relative}.cg-card.flipped .cg-card-inner{transform:rotateY(180deg)}.cg-card-back,.cg-card-front{position:absolute;width:100%;height:100%;backface-visibility:hidden;border-radius:10px;display:flex;align-items:center;justify-content:center}.cg-card-front{background:#888}.cg-card.clicked,.cg-card:active{transform:scale(1.06);box-shadow:0 10px 28px rgba(0,0,0,.28)}.cg-card-back{background:#fff;transform:rotateY(180deg);overflow:hidden}.cg-card-back img{width:80%;height:80%;object-fit:contain;border-radius:var(--radius-sm)}.cg-lock{position:absolute;right:6px;top:6px;background:rgba(0,0,0,.4);color:#fff;width:20px;height:20px;display:flex;align-items:center;justify-content:center;border-radius:var(--radius-pill);font-weight:700;font-size:14px}.cg-header{display:flex;gap:6px;align-items:center;justify-content:space-between;margin:var(--space-xs) auto;padding:var(--space-sm) 12px;width:min(720px,96%);border-radius:var(--radius-lg);position:sticky;top:12px;z-index:60;flex-wrap:wrap}#cg-timer{font-size:1rem;font-weight:700;color:var(--fg);letter-spacing:.6px;min-width:25px;text-align:left}#cg-timer.cg-running{color:#34d399}#cg-accuracy{color:var(--muted);font-weight:600;margin-left:var(--space-sm)}.cg-stats{display:flex;align-items:center;gap:var(--space-sm);flex:1 1 auto;min-width:0}.cg-controls{display:flex;align-items:center;gap:var(--space-sm);flex:0 0 auto}.cg-header button{margin-left:var(--space-sm);flex:0 0 auto}.cg-result{text-align:center;font-size:1.05rem;border-radius:14px;padding:14px var(--space-lg);max-width:480px;margin:18px auto 0}.cg-result h3{margin:0 0 6px;font-size:1.15rem}.cg-result .stats{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;color:var(--muted);font-weight:600}.cg-result .big-num{font-size:1.25rem;font-weight:700;color:var(--fg)}.cg-rules{width:min(720px,96%);margin:14px auto 28px;border-radius:var(--radius-lg);padding:12px var(--space-lg);color:var(--fg)}.cg-rules h4{margin:0 0 var(--space-sm);font-size:1.05rem}.cg-rules ul{margin:0;padding-left:18px;color:var(--muted)}@media (max-width:420px){.cg-header{gap:var(--space-sm);padding:var(--space-sm)}#cg-timer{font-size:1rem}.cg-board{grid-template-columns:repeat(4,56px);grid-template-rows:repeat(4,56px);gap:var(--space-xs);padding:10px}.cg-card{width:56px;height:56px}}#page-awards .awards-grid{display:grid;gap:var(--space-xs);grid-template-columns:repeat(4,minmax(120px,240px));align-items:center;justify-items:center;justify-content:center}#page-awards .awards-grid img{width:100%;height:auto;display:block;max-width:100%;object-fit:cover}#page-awards .grid .title{text-align:left}@media (max-width:700px){#page-awards .awards-grid{grid-template-columns:repeat(2,minmax(120px,240px));justify-content:center}}.dema-panel{position:fixed;left:0;right:0;bottom:0;z-index:100;background:var(--glass-bg);border-top:1px solid var(--glass-border);backdrop-filter:saturate(1.8) blur(16px);-webkit-backdrop-filter:saturate(1.8) blur(16px);box-shadow:0 -4px 24px rgba(0,0,0,.25);transform:translateY(100%);transition:transform var(--duration-slow) cubic-bezier(.4, 0, .2, 1);display:flex;flex-direction:column;max-height:280px}.dema-panel.open{transform:translateY(0)}.dema-controls{display:flex;align-items:center;gap:var(--space-md);padding:var(--space-xs) var(--space-sm);margin:var(--space-xs) var(--space-sm);border-bottom:1px solid var(--border);flex-wrap:wrap;min-height:45px;position:relative}.dema-controls--bottom{border-bottom:none;border-top:1px solid var(--border);justify-content:center;min-height:28px;padding:4px var(--space-sm)}.dema-controls-left{display:flex;align-items:center;gap:var(--space-sm);z-index:1}.dema-controls-center{position:absolute;left:50%;transform:translateX(-50%);display:flex;align-items:center;gap:var(--space-sm)}.dema-controls-right{display:flex;align-items:center;gap:var(--space-sm);margin-left:auto;z-index:1}.dema-btn{display:inline-flex;align-items:center;justify-content:center;min-width:28px;height:28px;padding:0 var(--space-xs);border:1px solid var(--border);border-radius:var(--radius-sm);background:var(--card);color:var(--fg);font-size:12px;cursor:pointer;transition:all var(--duration-normal) ease}.dema-btn:hover{background:var(--card-2);border-color:var(--accent)}.dema-btn:active{transform:scale(.96)}.dema-btn:disabled{opacity:.4;cursor:not-allowed}.dema-btn--icon{padding:0;width:28px}.dema-btn--play{width:32px;height:32px;border-radius:var(--radius-pill);background:var(--accent);border-color:var(--accent);color:var(--chip-fg)}.dema-btn--play:hover{filter:brightness(1.1);border-color:var(--accent)}.dema-time{font-family:ui-monospace,'SF Mono',monospace;font-size:12px;color:var(--muted);min-width:100px;text-align:center}.dema-volume-wrap,.dema-zoom-wrap{display:flex;align-items:center;gap:var(--space-xs)}.dema-volume-label,.dema-zoom-label{font-size:12px;color:var(--muted);white-space:nowrap;width:70px;text-align:right}.dema-volume-slider,.dema-zoom-slider{width:120px;flex:0 0 120px;height:4px;accent-color:var(--accent);margin:0;cursor:pointer}.dema-tracks-wrap{flex:1;overflow-x:scroll;overflow-y:hidden;position:relative;cursor:grab;scrollbar-width:none;-ms-overflow-style:none}.dema-tracks-wrap::-webkit-scrollbar{display:none}.dema-tracks-wrap.dragging{cursor:grabbing;user-select:none}.dema-tracks-scroll{display:flex;flex-direction:column;min-width:100%;position:relative}.dema-timeline{height:25px;background:var(--card-2);border-bottom:1px solid var(--border);position:sticky;top:0;z-index:5}.dema-timeline-canvas{width:100%;height:100%}.dema-track{height:35px;position:relative;border-bottom:1px solid var(--border);background:var(--card)}.dema-track:nth-child(odd){background:var(--card-2)}.dema-track-label{position:absolute;left:0;top:0;bottom:0;width:32px;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:600;color:var(--muted);background:inherit;border-right:1px solid var(--border);z-index:3}.dema-track-content{position:absolute;left:32px;top:0;right:0;bottom:0;overflow:visible}.dema-clip{position:absolute;top:2px;height:calc(100% - 4px);min-width:20px;border-radius:var(--radius-sm);cursor:grab;display:flex;align-items:center;overflow:hidden;box-shadow:var(--shadow-sm);border:1px solid rgba(255,255,255,.15);transition:box-shadow var(--duration-normal) ease,transform var(--duration-fast) ease;user-select:none;touch-action:none}.dema-clip:hover{box-shadow:var(--shadow-md);z-index:10}.dema-clip.selected{outline:2px solid var(--accent);outline-offset:1px;z-index:20}.dema-clip.dragging{cursor:grabbing;opacity:.85;z-index:30;transform:scale(1.02)}.dema-clip-label{position:relative;z-index:1;padding:0 4px;font-size:15px;font-weight:700;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Noto Sans TC','Microsoft JhengHei',sans-serif;color:rgba(0,0,0,.6);text-shadow:0 0 2px rgba(255,255,255,.5);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%}.dema-clip-handle{position:absolute;top:0;bottom:0;width:20px;cursor:ew-resize;z-index:10;opacity:0;transition:opacity var(--duration-normal) ease;background:0 0}.dema-clip-handle::after{content:'';position:absolute;top:4px;bottom:4px;width:4px;background:var(--accent);border-radius:2px}.dema-clip-handle--left{left:-8px}.dema-clip-handle--left::after{left:8px}.dema-clip-handle--right{right:-8px}.dema-clip-handle--right::after{right:8px}.dema-clip:hover .dema-clip-handle{opacity:1}.dema-clip.selected .dema-clip-handle{opacity:1}.dema-clip-wave{position:absolute;inset:0;pointer-events:none}.dema-clip-wave canvas{width:100%;height:100%;opacity:.9}.dema-playhead{position:absolute;top:0;bottom:0;width:2px;background:var(--accent-2);z-index:50;pointer-events:none;transform:translateX(-1px)}.dema-playhead::before{content:'';position:absolute;top:-2px;left:50%;transform:translateX(-50%);width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-top:8px solid var(--accent-2)}.dema-empty{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;color:var(--muted);font-size:13px;pointer-events:none}@media (max-width:600px){.dema-panel{max-height:260px}.dema-controls{padding:var(--space-xs) var(--space-sm);gap:var(--space-sm) var(--space-xs)}.dema-controls-center{position:static;transform:none;order:1;flex-basis:100%;justify-content:center;padding-top:4px}.dema-controls-left,.dema-controls-right{flex:1;min-width:0}.dema-controls-right{justify-content:flex-end}.dema-time{display:none}.dema-volume-wrap,.dema-zoom-wrap{flex-wrap:wrap;justify-content:center;gap:2px}.dema-volume-slider,.dema-zoom-slider{width:100px;flex:0 0 100px}@media (max-width:380px){.dema-volume-slider,.dema-zoom-slider{width:80px;flex:0 0 80px}}.dema-volume-label,.dema-zoom-label{font-size:10px;text-align:center;width:auto}.dema-track-content{left:24px}}@media (max-width:400px){.dema-volume-slider,.dema-zoom-slider{width:100px}}body.dema-open .stage{bottom:220px}body.dema-open .bg-credit{bottom:230px}:root.light .dema-clip{border-color:rgba(0,0,0,.1)}:root.light .dema-clip-label{text-shadow:0 1px 2px rgba(255,255,255,.5)}</style></head><body><div class="wrap"><header><h1>é˜¿è¬èˆ‡å‹•ç‰©æœ‹å‹æŒ‰éˆ•2686</h1><button id="navToggle" class="nav-toggle" aria-label="æ‰“é–‹é¸å–®" aria-expanded="false" aria-controls="primaryNav" title="é¸å–®"><svg width="22" height="22" viewBox="0 0 24 24" aria-hidden="true"><path d="M3 6h18M3 12h18M3 18h18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg></button><nav id="primaryNav" class="tabs" role="tablist" aria-label="ä¸»é¸å–®"><button id="tab-home" class="tab active" data-page="home" role="tab" aria-selected="true" aria-controls="page-home">ä¸»é </button> <button id="tab-game" class="tab" data-page="game" role="tab" aria-selected="false" aria-controls="page-game">å°éŠæˆ²</button> <button id="tab-about" class="tab" data-page="about" role="tab" aria-selected="false" aria-controls="page-about">é—œæ–¼</button> <button id="tab-awards" class="tab" data-page="awards" role="tab" aria-selected="false" aria-controls="page-awards">ç¥¨é¸çµæœ</button> <button id="settingsBtn" class="tab" aria-label="é–‹å•Ÿè¨­å®šé¢æ¿" aria-haspopup="dialog">è¨­å®š</button></nav></header><main id="page-home" role="tabpanel" aria-labelledby="tab-home"><div id="anniversaryZone" class="anniversary-zone gradient-r1-background"><div class="anniversary-content" role="button" aria-label="æ…¶ç¥ä¸‰é€±å¹´"><div class="anniversary-text">ğŸ‰ä¸‰é€±å¹´å¿«æ¨‚ğŸ‰</div></div></div><div class="search-row"><div class="searchbar" role="search"><svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16a6.471 6.471 0 0 0 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"/></svg> <input id="q" placeholder="æœå°‹æ¨™é¡Œæˆ– #æ¨™ç±¤ï¼ˆå¯å¤šå€‹ï¼Œç”¨ç©ºç™½åˆ†éš”ï¼‰" autocomplete="off" aria-label="æœå°‹éŸ³æ•ˆ"><div id="activeChips" class="chips" role="list" aria-label="å·²é¸å–çš„æœå°‹æ¨™ç±¤"></div></div><button id="clearBtn" class="btn" aria-label="æ¸…é™¤æœå°‹">æ¸…é™¤</button></div><div id="tagList" class="tag-list" role="list" aria-label="å¯é»é¸çš„éŸ³æ•ˆæ¨™ç±¤"></div><section aria-labelledby="fav-section-title"><div class="section-header"><h3 id="fav-section-title">æœ€æ„›éŸ³æ•ˆ</h3><div class="actions"><button id="sortFavBtn" class="btn small-btn" aria-label="é–‹å•Ÿæ‰‹å‹•æ’åˆ—æ¨¡å¼">æ‰‹å‹•æ’åˆ—</button> <button id="doneSortBtn" class="btn small-btn glow-persistent hidden" aria-label="å„²å­˜ç›®å‰æ’åˆ—é †åº">å„²å­˜æ’åˆ—</button> <button id="shareFavBtn" class="btn small-btn" aria-label="åˆ†äº«æœ€æ„›åˆ—è¡¨">åˆ†äº«</button></div></div><div id="favGrid" class="grid" role="list" aria-label="æœ€æ„›éŸ³æ•ˆåˆ—è¡¨"></div><div id="favEmpty" class="empty hidden" role="status">é‚„æ²’æœ‰æœ€æ„›ã€‚é»éŸ³æ•ˆå³ä¸Šçš„ â¤ï¸ åŠ å…¥æœ€æ„›ã€‚</div></section><section id="receivedSection" class="hidden" aria-labelledby="received-section-title"><div id="receivedHeader" class="section-header"><h3 id="received-section-title">æ”¶åˆ°çš„åˆ—è¡¨</h3></div><div id="receivedGrid" class="grid" role="list" aria-label="æ”¶åˆ°çš„éŸ³æ•ˆåˆ—è¡¨"></div></section><section aria-labelledby="all-sounds-title"><div class="section-header"><h3 id="all-sounds-title">å…¨éƒ¨éŸ³æ•ˆ</h3><div class="actions"><button id="openDemaBtn" class="btn small-btn" aria-label="é–‹å•Ÿå¤šè»Œæ··éŸ³ç·¨è¼¯å™¨">æ··éŸ³</button> <button id="shuffleBtn" class="btn small-btn" aria-label="éš¨æ©Ÿæ’åˆ—éŸ³æ•ˆé †åº">æ´—ç‰Œ</button> <button id="resetOrderBtn" class="btn small-btn" aria-label="æ¢å¾©é è¨­æ’åˆ—é †åº">é è¨­é †åº</button></div></div><p class="desc">æç¤ºï¼šé»éŸ³æ•ˆå³å¯æ’­æ”¾ï¼›å³éµï¼ˆæˆ–è¡Œå‹•è£ç½®é•·æŒ‰ï¼‰å¯åˆ†äº«/ä¸‹è¼‰ã€‚</p><div id="grid" class="grid" role="list" aria-label="å…¨éƒ¨éŸ³æ•ˆåˆ—è¡¨"></div><div id="empty" class="empty hidden" role="status">æ²’æœ‰ç¬¦åˆæœå°‹çš„éŸ³æ•ˆã€‚</div></section></main><div id="page-game" class="hidden" role="tabpanel" aria-labelledby="tab-game"><div id="concentration-game" role="application" aria-label="è¨˜æ†¶å°éŠæˆ²"><div class="cg-header"><div class="cg-stats" aria-live="polite"><span id="cg-timer" aria-label="éŠæˆ²æ™‚é–“">00:00</span> <span id="cg-accuracy" aria-label="æº–ç¢ºç‡">æº–ç¢ºç‡ï¼š--%</span></div><div class="cg-controls"><button id="cg-restart" class="btn small-btn" aria-label="é‡æ–°é–‹å§‹éŠæˆ²">é‡é–‹ä¸€å±€</button></div></div><div id="cg-board" class="cg-board" role="grid" aria-label="è¨˜æ†¶å¡ç‰Œé¢æ¿"></div><div id="cg-result" class="cg-result hidden" role="alert" aria-live="assertive"></div><div id="cg-rules" class="cg-rules" aria-labelledby="cg-rules-title"><h4 id="cg-rules-title">è¨˜æ†¶å°éŠæˆ²è¦å‰‡</h4><ul><li>ç¬¬ä¸€æ¬¡ç¿»é–‹çš„ç‰Œä¸å°è¨ˆåˆ†é€ æˆå½±éŸ¿ï¼Œå±¬æ–¼è¨˜æ†¶æç¤ºã€‚</li><li>æ¯ç¿»é–‹å…©å¼µå¡ï¼Œè‹¥ç‚ºç›¸åŒä¸»æ’­çš„ç›¸åŒéŸ³æ•ˆå³ç‚ºé…å°ï¼Œå…±æœ‰ 8 å°é…å°ã€‚</li><li>ï¼ˆä¸æœƒå‡ºç¾å¸¶æœ‰ã€Œé«’è©±ã€æˆ–ã€ŒSUSã€æ¨™ç±¤çš„èªéŸ³ï¼Œä½†æ˜¯æœƒæœ‰å°–å«ï¼Œè«‹å°å¿ƒè€³è†œã€‚ï¼‰</li></ul></div></div></div><div id="page-about" class="hidden" role="tabpanel" aria-labelledby="tab-about"><div class="about-content"><p>æœ¬ç«™ç”±ç²‰è‚è£½ä½œï¼Œä¸¦éç”±å­ä¸–é†«å¸«é˜¿è¬å®˜æ–¹ç¶“ç‡Ÿã€‚éŸ³æ•ˆå…§å®¹çš†æ˜¯ç²‰è‚å»è„ˆçµ¡å¼ã€æ–·ç« å–ç¾©çš„å‰ªè¼¯ï¼Œåƒ…ä¾›å¨›æ¨‚ã€‚æœ¬ç«™çš„éŸ³æ•ˆçš†å±¬æ–¼åŸä½œè€…å­ä¸–é†«å¸«é˜¿è¬ï¼Œä½¿ç”¨æ™‚é ˆéµå®ˆå­ä¸–é†«å¸«é˜¿è¬çš„äºŒæ¬¡å‰µä½œæ¢ä¾‹ã€‚</p><p>æœ€å¾Œæ›´æ–°æ™‚é–“ï¼š2025/12/7ã€‚</p><p>é˜¿è¬æœ¬å®¶â†’ <a href="https://x.com/drlifesucks" target="_blank">å­ä¸–é†«å¸«é˜¿è¬X</a>ã€<a href="https://www.youtube.com/@Dr.lifesucks" target="_blank">å­ä¸–é†«å¸«é˜¿è¬Youtube</a></p><p><a href="https://discord.gg/e6ch4VbRB4" target="_blank">éŸ³æ•ˆæ¿å•é¡Œå›å ±èˆ‡å»ºè­°å€</a></p><p>SNS Hashtagï¼š#è¬ç±Ÿèšé›†</p><img src="assets/art-by-sigh.png" alt="" style="margin:0 auto;max-width:100%;max-height:250px;display:block;object-fit:cover"><p style="text-align:right">æ’ç•«ï¼š<a href="https://x.com/sigh121212" target="_blank">Minie(Sigh)</a></p><h2>å¤§å¾·èŠ³åéŒ„</h2><p>æ„Ÿè¬53ã€Kieåœ¨DCå¼„äº†ä¸€å †éŸ³æ•ˆï¼Œè®“å—æƒ³åˆ°å¯ä»¥åšé€™å€‹ç¶²ç«™ï¼Œä¸¦åœ¨æå‡ºé€™å€‹æƒ³æ³•çš„ä¸€é–‹å§‹å°±å¼„äº†ä¸€å †éŸ³æ•ˆéä¾†ã€‚é‚„æœ‰åŒæ¨£æ„Ÿè¬åœ¨åŸå‹éšæ®µå°±å¹«å¿™æ”¶é›†éŸ³æ•ˆçš„ç±³ç³•è·Ÿè–°è–°è‰ã€‚<br>æ„Ÿè¬Jiaç¹ªè£½è¶…å¯æ„›çš„èƒŒæ™¯åœ–è·Ÿæ”¶é›†äº†å¾ˆå¤šéŸ³æ•ˆã€‚<br><br>æ„Ÿè¬ç²‰è‚å€‘æ”¶é›†å¾ˆå¤šéŸ³æ•ˆï¼Œè±å¯Œäº†é€™å€‹ç¶²ç«™ï¼ˆWordç­†åŠƒé †ï¼‰ï¼š<br>AmBinBongã€CZã€HUIã€Lococco de suzuranã€Nokimi07ã€Sighã€TENNã€Yichenæ²‰æ²‰ã€ğŸŒ™ğŸ°æœˆæ¡‚è‘‰é¦™åŒ…â™ğŸµã€å¸ƒä¸(25:00)ã€å¹¸ç¦æŸ´æŸ´ã€é’æœ«æã€å‡Œä¼ŠLingYiï¼ˆ01ï¼‰ã€å¤ç™½è¡«ã€æ¾â–½ç±³ç²‰ è‚‰å¹²ã€è²“è²“é›¨ã€‚ ä»¥åŠå…¶ä»–å›å ±å•é¡Œã€æå‡ºå»ºè­°çš„ç²‰è‚å€‘ï¼Œä½ å€‘è®“é€™å€‹ç¶²ç«™çš„åŠŸèƒ½æ›´å®Œå–„ã€‚</p></div><div class="bg-credit"><a href="https://x.com/jiauwu_0730" target="_blank" rel="noopener">èƒŒæ™¯æ’ç•«ç”± Jia ç¹ªè£½</a></div></div><div id="page-awards" class="hidden" role="tabpanel" aria-labelledby="tab-awards"><div style="max-width:1100px;margin:0 auto;padding:18px"><h2 style="text-align:center">ç¬¬ä¸€å±†éŸ³æ•ˆæ¿çˆ­éœ¸æˆ°</h2><div style="text-align:center;margin:12px 0"><div class="awards-grid" role="img" aria-label="ç¬¬ä¸€å±†ç²çè€…åœ–ç‰‡"><img src="assets/award1-1.jpg" alt="ç¬¬ä¸€å±†è²“ä¸‹å»"> <img src="assets/award1-2.jpg" alt="ç¬¬ä¸€å±†Matsuko"> <img src="assets/award1-3.jpg" alt="ç¬¬ä¸€å±†è±¹å­é ­"> <img src="assets/award1-4.jpg" alt="ç¬¬ä¸€å±†ç“¦å“ˆ"></div><h3 id="awards-top10-title">ç²çå€ï¼ˆå‰ååï¼‰</h3><div id="awards-top10" class="grid" role="list" aria-labelledby="awards-top10-title"></div><h3 id="awards-next20-title" style="margin-top:18px">å…¥åœçï¼ˆå¾Œ20åï¼‰</h3><div id="awards-next20" class="grid" role="list" aria-labelledby="awards-next20-title"></div></div></div></div><div id="settingsModal" class="modal-backdrop hidden" role="dialog" aria-modal="true" aria-labelledby="settingsTitle"><div class="modal"><h3 id="settingsTitle" style="margin-top:0;margin-bottom:12px">è¨­å®š</h3><div style="display:flex;flex-direction:column;gap:8px"><button id="themeBtn" class="btn" type="button" aria-label="åˆ‡æ›äº®è‰²/æš—è‰²ä¸»é¡Œ">é›»ç‡ˆé–‹é—œ</button> <label for="settingsVolume">æ’­æ”¾éŸ³é‡ï¼š <span id="settingsVolumeValue" aria-live="polite">100%</span></label> <input id="settingsVolume" type="range" min="0" max="100" step="1" value="100" aria-describedby="settingsVolumeValue"><div style="display:flex;justify-content:flex-end;margin-top:6px;gap:8px"><button id="settingsClose" class="btn" type="button" aria-label="é—œé–‰è¨­å®šé¢æ¿">é—œé–‰</button></div></div></div></div><div id="stage" class="stage" aria-hidden="true"></div><div id="menu" class="menu hidden" role="menu" aria-label="éŸ³æ•ˆé¸å–®"></div><div id="toast" class="toast hidden" role="status" aria-live="polite"></div><div id="demaPanel" class="dema-panel" role="dialog" aria-label="å¤šè»Œæ··éŸ³ç·¨è¼¯å™¨" aria-hidden="true"><div class="dema-controls"><div class="dema-controls-left"><div class="dema-volume-wrap" id="demaClipVolumeWrap" style="display:none"><input id="demaClipVolume" type="range" class="dema-volume-slider" min="0" max="150" value="100" step="5"> <span class="dema-volume-label">ç‰‡æ®µéŸ³é‡ <span id="demaClipVolumeValue">100%</span></span></div></div><div class="dema-controls-center"><button id="demaSkipBack" class="dema-btn dema-btn--icon" title="å›åˆ°ç‰‡æ®µé–‹é ­"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M6 6h2v12H6zm3.5 6 8.5 6V6z"/></svg></button> <button id="demaPlayPause" class="dema-btn dema-btn--play" title="æ’­æ”¾/æš«åœ"><svg id="demaPlayIcon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg> <svg id="demaPauseIcon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="display:none"><path d="M6 4h4v16H6zM14 4h4v16h-4z"/></svg></button> <button id="demaSkipNext" class="dema-btn dema-btn--icon" title="è·³åˆ°ä¸‹å€‹ç‰‡æ®µ"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/></svg></button></div><div class="dema-controls-right"><div class="dema-zoom-wrap"><span class="dema-zoom-label">æ™‚é–“è»¸ç¸®æ”¾</span> <input id="demaZoom" type="range" class="dema-zoom-slider" min="50" max="800" value="200" step="10"></div></div></div><div class="dema-tracks-wrap"><div id="demaTracksScroll" class="dema-tracks-scroll"><div class="dema-timeline"><canvas id="demaTimelineCanvas" class="dema-timeline-canvas"></canvas></div><div class="dema-track" data-track="0"><div class="dema-track-label">1</div><div class="dema-track-content" data-track-content="0"></div></div><div class="dema-track" data-track="1"><div class="dema-track-label">2</div><div class="dema-track-content" data-track-content="1"></div></div><div class="dema-track" data-track="2"><div class="dema-track-label">3</div><div class="dema-track-content" data-track-content="2"></div></div><div id="demaPlayhead" class="dema-playhead" style="left:32px"></div></div><div id="demaEmpty" class="dema-empty">å³éµé»æ“ŠéŸ³æ•ˆå¡ç‰‡ï¼Œé¸æ“‡ã€ŒåŠ åˆ°éŸ³è»Œã€ä¾†é–‹å§‹æ··éŸ³</div></div><div class="dema-controls dema-controls--bottom"><div class="dema-controls-left"><button id="demaUndo" class="dema-btn dema-btn--icon" title="å¾©åŸ (Ctrl+Z)" disabled="disabled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 10h10a5 5 0 0 1 5 5v2M3 10l5-5M3 10l5 5"/></svg></button> <button id="demaRedo" class="dema-btn dema-btn--icon" title="é‡åš (Ctrl+Y)" disabled="disabled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 10H11a5 5 0 0 0-5 5v2M21 10l-5-5M21 10l-5 5"/></svg></button> <button id="demaClear" class="dema-btn" title="é‡ç½®æ‰€æœ‰éŸ³è»Œèˆ‡æ­¥é©Ÿç´€éŒ„">é‡ç½®</button> <button id="demaRemoveSelected" class="dema-btn" title="ç§»é™¤é¸å–çš„ç‰‡æ®µ (Delete)" disabled="disabled">ç§»é™¤é¸æ“‡</button></div><div class="dema-controls-center"><span id="demaTime" class="dema-time">00:00.00 / 00:00.00</span></div><div class="dema-controls-right"><button id="demaClose" class="dema-btn dema-btn--icon" title="é—œé–‰é¢æ¿"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18M6 6l12 12"/></svg></button></div></div></div><script src="scripts/Sortable.min.js"></script><script>!function(){"use strict";const e={paths:{tags:"config/tags.json",sounds:"config/sounds.json",voteResults:"config/vote-results.json"},storage:{favorites:"favorites",favoritesVersion:"favorites_version",favoritesBackup:"favorites_legacy_backup",theme:"theme",globalVolume:"globalVolume"},timing:{toastDuration:2500,longPressDelay:400,searchDebounce:180,animationDelay:60,hopOutDelay:90},ui:{batchSize:72},awards:{topRankCount:30,top10Count:10,next20Count:20},game:{pairCount:8,cardFlipDelay:500,rewardAccuracy:90,rewardSoundIds:["c4B1fg","Hv3yFA","JkJ9-A","5VHtAg"]},colors:{defaultTag:"#94a3b8"}},t={linkCopied:"å·²è¤‡è£½åˆ†äº«é€£çµ",listLinkCopied:"å·²è¤‡è£½åˆ†äº«æœ€æ„›åˆ—è¡¨é€£çµ",noFavorites:"æ²’æœ‰æœ€æ„›å¯åˆ†äº«",sortingSaved:"å·²å„²å­˜æœ€æ„›æ’åº",sortingBlocked:"æ­£åœ¨ç·¨è¼¯æœ€æ„›æ’åºï¼Œç„¡æ³•è®Šæ›´æœ€æ„›",favMigrated:(e,t)=>`å·²å‡ç´šæœ€æ„›æ ¼å¼ï¼Œå…± ${e} ç­†${t?`ï¼›æœªåŒ¹é… ${t} ç­†`:""}ã€‚`,gameReward:"ä½ æ˜¯è¨˜æ†¶çŒ›è‚"},n={configLoadFailed:"è¼‰å…¥è¨­å®šæª”å¤±æ•—ï¼Œè«‹ç¢ºèª <code>config/</code> è·¯å¾‘æ˜¯å¦æ­£ç¢ºã€‚",gameNoSounds:"ç›®å‰æ²’æœ‰è¶³å¤ çš„éŸ³æ•ˆå¯ä¾›é…å°ï¼ˆéœ€è‡³å°‘ 1 çµ„ï¼‰ã€‚è«‹å›åˆ°ä¸»é æˆ–ç¨å¾Œå†è©¦ã€‚"},o=e=>e+(e.includes("?")?"&":"?")+"v="+encodeURIComponent("ver2025-12-7");function a(e,t=Math.random){for(let n=e.length-1;n>0;n--){const o=Math.floor(t()*(n+1));[e[n],e[o]]=[e[o],e[n]]}return e}const s={q:document.getElementById("q"),activeChips:document.getElementById("activeChips"),clearBtn:document.getElementById("clearBtn"),tagList:document.getElementById("tagList"),grid:document.getElementById("grid"),favGrid:document.getElementById("favGrid"),empty:document.getElementById("empty"),favEmpty:document.getElementById("favEmpty"),settingsBtn:document.getElementById("settingsBtn"),themeBtn:document.getElementById("themeBtn"),stage:document.getElementById("stage"),navToggle:document.getElementById("navToggle"),get menu(){return document.getElementById("menu")},get toast(){return document.getElementById("toast")},get navTabs(){return document.querySelectorAll(".tab[data-page]")},pageHome:document.getElementById("page-home"),pageGame:document.getElementById("page-game"),pageAbout:document.getElementById("page-about"),pageawards:document.getElementById("page-awards"),settingsModal:document.getElementById("settingsModal"),settingsClose:document.getElementById("settingsClose"),settingsVolume:document.getElementById("settingsVolume"),settingsVolumeValue:document.getElementById("settingsVolumeValue"),receivedSection:document.getElementById("receivedSection"),receivedGrid:document.getElementById("receivedGrid"),awardsTop10:document.getElementById("awards-top10"),awardsNext20:document.getElementById("awards-next20"),sortFavBtn:document.getElementById("sortFavBtn"),doneSortBtn:document.getElementById("doneSortBtn"),shareFavBtn:document.getElementById("shareFavBtn"),shuffleBtn:document.getElementById("shuffleBtn"),resetOrderBtn:document.getElementById("resetOrderBtn"),openDemaBtn:document.getElementById("openDemaBtn"),demaPanel:document.getElementById("demaPanel"),demaUndo:document.getElementById("demaUndo"),demaRedo:document.getElementById("demaRedo"),demaPlayPause:document.getElementById("demaPlayPause"),demaPlayIcon:document.getElementById("demaPlayIcon"),demaPauseIcon:document.getElementById("demaPauseIcon"),demaSkipBack:document.getElementById("demaSkipBack"),demaSkipNext:document.getElementById("demaSkipNext"),demaTime:document.getElementById("demaTime"),demaZoom:document.getElementById("demaZoom"),demaClear:document.getElementById("demaClear"),demaRemoveSelected:document.getElementById("demaRemoveSelected"),demaClose:document.getElementById("demaClose"),demaTracksScroll:document.getElementById("demaTracksScroll"),demaTimelineCanvas:document.getElementById("demaTimelineCanvas"),demaPlayhead:document.getElementById("demaPlayhead"),demaEmpty:document.getElementById("demaEmpty"),get demaTrackContents(){return document.querySelectorAll("[data-track-content]")},demaClipVolumeWrap:document.getElementById("demaClipVolumeWrap"),demaClipVolume:document.getElementById("demaClipVolume"),demaClipVolumeValue:document.getElementById("demaClipVolumeValue")},l={tags:{},tagList:[],usedTagList:[],sounds:[],soundMap:new Map,defaultSoundsSnapshot:[],favorites:JSON.parse(localStorage.getItem(e.storage.favorites)||"[]"),favSet:new Set,isSorting:!1,sortable:null,queryText:"",queryTags:new Set,page:"home",contextTimer:null,toastTimer:null,highlightedCardId:"",receivedList:[],cgRunning:!1,displayList:[],renderedCount:0,observer:null};l.favSet=new Set(l.favorites),l.globalVolume=(()=>{const t=localStorage.getItem(e.storage.globalVolume),n=Number(t);return null!==t&&!isNaN(n)&&n>=0&&n<=1?n:1})();let i=null;function r(e,t={}){const{snd:n,onPlay:o,onEnded:a,preload:s="auto",loop:i=!1,autoplay:r=!0}=t;try{const t=new Audio(e);return Object.assign(t,{preload:s,loop:i}),o&&t.addEventListener("play",()=>o(n,t)),a&&t.addEventListener("ended",()=>a(n,t)),(e=>{try{e&&(e.volume=l.globalVolume)}catch(e){console.warn("[applyVolumeToAudio] è¨­å®šéŸ³é‡å¤±æ•—",e)}})(t),r&&t.play().catch(()=>{}),t}catch(e){return console.warn("[createPlayer] failed",e),null}}const d=e=>e?.src?r(e.src,{snd:e,onPlay:M,onEnded:P}):null,c={el(e,t={},n=[]){const o=document.createElement(e);for(const[e,n]of Object.entries(t))"class"===e?o.className=n:"style"===e?Object.assign(o.style,n):e.startsWith("on")&&"function"==typeof n?o.addEventListener(e.slice(2),n):null!=n&&o.setAttribute(e,n);for(const e of[].concat(n).filter(Boolean))o.append(e);return o},svgHeart(){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");return e.setAttribute("viewBox","0 0 24 24"),e.innerHTML='<path d="M12 21s-6.716-4.438-9.428-7.15C.59 11.868.59 8.608 2.57 6.627 4.55 4.647 7.81 4.647 9.79 6.627L12 8.838l2.21-2.21c1.98-1.98 5.24-1.98 7.22 0 1.98 1.98 1.98 5.24 0 7.223C18.716 16.562 12 21 12 21z" fill="none" stroke="currentColor" stroke-width="1.5"/>',e}},u={slug:e=>e.normalize("NFKC").trim(),byId:e=>document.getElementById(e),saveFav:()=>localStorage.setItem(e.storage.favorites,JSON.stringify(l.favorites)),inFav:e=>l.favSet.has(e),download(e,t){const n=Object.assign(document.createElement("a"),{href:e,download:t||""});document.body.appendChild(n),n.click(),n.remove()},parseQuery(){const e=l.queryText.trim().split(/\s+/).filter(Boolean),t=new Set([...l.queryTags]),n=[];for(const o of e)o.startsWith("#")?t.add(u.slug(o.slice(1))):n.push(u.slug(o));return{terms:n,tags:t}},match(e,t,n){const o=e.title.toLowerCase(),a=e.tags.map(e=>u.slug(e));for(const e of n)if(!a.includes(e))return!1;for(const n of t){const t=n.toLowerCase();if(!o.includes(t)&&!e.tags.some(e=>e.toLowerCase().includes(t)))return!1}return!0},debounce(e,t=200){let n;return(...o)=>{clearTimeout(n),n=setTimeout(()=>e(...o),t)}}};function m(){const{terms:e,tags:t}=u.parseQuery(),n=new URLSearchParams(window.location.search);return e.length?n.set("q",e.join(" ")):n.delete("q"),t.size?n.set("tags",[...t].join(",")):n.delete("tags"),n.delete("sound"),n}function g(e=!1){const t=m(),n=new URLSearchParams(location.search);n.has("list")&&t.set("list",n.get("list")),n.has("sound")&&t.set("sound",n.get("sound")),l.page&&"home"!==l.page?t.set("page",l.page):t.delete("page");const o=t.toString(),a=`${location.pathname}${o?"?"+o:""}`;(e?history.pushState:history.replaceState).call(history,null,"",a)}function h(){const e=new URLSearchParams(location.search),t=e.get("q")||"",n=e.get("tags")||"";l.queryTags.clear();const o=n.split(",").map(e=>u.slug(e)).filter(Boolean);o.forEach(e=>l.queryTags.add(e)),l.queryText=t;const a=o.map(e=>"#"+(l.tags[e]?.name||e));s.q.value=[t,...a].filter(Boolean).join(" ");const i=e.get("page");l.page=["game","about","awards"].includes(i)?i:"home",l.receivedList=e.get("list")?.split(",").filter(Boolean)??[]}function f(){const e=new URLSearchParams(location.search).get("sound");if(!e)return;const t=u.byId("snd-"+e);t&&(t.scrollIntoView({behavior:"smooth",block:"center"}),l.highlightedCardId&&u.byId("snd-"+l.highlightedCardId)?.classList.remove("glow-persistent"),l.highlightedCardId=e,t.classList.add("glow-persistent"))}window.addEventListener("popstate",()=>{h(),A(),f()});const p={home:"pageHome",game:"pageGame",about:"pageAbout",awards:"pageawards"},v=(e,t,n)=>{try{document.dispatchEvent(new CustomEvent("pageChange",{detail:{page:e,prevPage:t,phase:n}}))}catch(e){console.warn("[dispatchPageEvent] äº‹ä»¶æ´¾ç™¼å¤±æ•—",e)}};function y(e){const t=l.page;v(e,t,"before"),l.page=e;for(const[t,n]of Object.entries(p))s[n]?.classList.toggle("hidden",t!==e);s.navTabs.forEach(t=>{const n=t.getAttribute("data-page")===e;t.classList.toggle("active",n),"tab"===t.getAttribute("role")&&t.setAttribute("aria-selected",String(n))}),document.body.classList.toggle("bg-full","about"===e),document.body.classList.remove("nav-open"),s.navToggle?.setAttribute("aria-expanded","false"),g(!0),v(e,t,"after")}const b=e=>navigator.clipboard?.writeText(e).catch(()=>E(e))??E(e);function E(e){const t=Object.assign(document.createElement("textarea"),{value:e,style:"position:fixed;left:-9999px"});document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch{console.warn("[legacyCopy] execCommand ä¸æ”¯æ´")}return t.remove(),Promise.resolve()}function S(t,n=e.timing.toastDuration){const o=s.toast;o&&(clearTimeout(l.toastTimer),o.textContent=t,o.classList.remove("hidden"),n>0&&(l.toastTimer=setTimeout(()=>o.classList.add("hidden"),n)))}function L(e,n,o){const a=s.menu;if(!a)return;a.innerHTML="";const l=c.el("div",{class:"menu-item",role:"menuitem",tabindex:"0"},"åŠ åˆ°éŸ³è»Œ");l.addEventListener("click",()=>{k(),void 0!==_&&_.addSoundToTrack&&_.addSoundToTrack(e)});const i=c.el("div",{class:"menu-item",role:"menuitem",tabindex:"0"},"åˆ†äº«ç¶²å€");i.addEventListener("click",async()=>{var n;await b((n=e.id,`${location.href.replace(/[?#].*$/,"")}?sound=${encodeURIComponent(n)}`)),k(),S(t.linkCopied)});const r=c.el("div",{class:"menu-item",role:"menuitem",tabindex:"0"},"ä¸‹è¼‰éŸ³æª”");r.addEventListener("click",()=>{k(),u.download(e.src,e.file)}),a.append(l,i,r),a.classList.remove("hidden"),requestAnimationFrame(()=>w(n,o))}function w(e,t){const n=s.menu;if(!n)return;const o=n.offsetWidth||180,a=n.offsetHeight||100,l=window.innerWidth,i=window.innerHeight;n.style.left=Math.min(Math.max(0,e),l-o-6)+"px",n.style.top=Math.min(Math.max(0,t),i-a-6)+"px"}const k=()=>{const e=s.menu;e&&(e.classList.add("hidden"),e.innerHTML="")};document.addEventListener("click",e=>{!s.menu||s.menu.classList.contains("hidden")||s.menu.contains(e.target)||k()}),document.addEventListener("keydown",e=>{"Escape"===e.key&&k()}),window.addEventListener("resize",k);const T=e=>{document.body.classList.add("no-transition"),document.documentElement.classList.toggle("light","light"===e),document.body.offsetHeight,document.body.classList.remove("no-transition")},I=localStorage.getItem(e.storage.theme)||(matchMedia("(prefers-color-scheme:light)").matches?"light":"dark");T(I),s.themeBtn.addEventListener("click",()=>{const t=document.documentElement.classList.contains("light")?"dark":"light";"dark"===t&&(e=>{const t=l.soundMap.get(e);t&&d(t)})("oNTWqg"),localStorage.setItem(e.storage.theme,t),T(t)});const $=(e,t,n)=>{if(e&&(e.classList.toggle("hidden",!t),e.setAttribute("aria-hidden",String(!t)),n))try{n.focus()}catch{}},C=()=>$(s.settingsModal,!1),B=()=>s.settingsModal&&!s.settingsModal.classList.contains("hidden");s.settingsBtn?.addEventListener("click",e=>{e.preventDefault(),$(s.settingsModal,!0);const t=Math.round(100*(l.globalVolume??1));s.settingsVolume&&(s.settingsVolume.value=String(t)),s.settingsVolumeValue&&(s.settingsVolumeValue.textContent=`${t}%`)}),s.settingsClose?.addEventListener("click",C),document.addEventListener("click",e=>{B()&&e.target===s.settingsModal&&C()}),document.addEventListener("keydown",e=>{"Escape"===e.key&&B()&&C()}),s.settingsVolume?.addEventListener("input",()=>{const t=Math.max(0,Math.min(100,Number(s.settingsVolume.value)||0))/100;l.globalVolume=t;try{localStorage.setItem(e.storage.globalVolume,String(t))}catch(e){console.warn("[settings] å„²å­˜éŸ³é‡è¨­å®šå¤±æ•—",e)}s.settingsVolumeValue&&(s.settingsVolumeValue.textContent=`${Math.round(100*t)}%`),(e=>{const t=mixAudio?.masterGain?.gain;if(t)try{t.value=e}catch(n){console.warn("[updateMixMasterGain] ç›´æ¥è¨­å®šå¤±æ•—ï¼Œå˜—è©¦ rampTo",n),t.rampTo?.(e,.02)}})(t)});const x=new Set;function M(e,t){const n=e.tags.map(e=>l.tags[u.slug(e)]).filter(e=>"streamer"===e?.role&&e.avatar);if(!n.length)return;const a=c.el("div",{class:"group"});x.add(a),n.forEach((e,t)=>{const n=c.el("div",{class:"avatar pop-in jit",style:{animationDelay:60*t+"ms"}},[c.el("img",{src:o(e.avatar),alt:e.name})]);a.appendChild(n)}),s.stage.appendChild(a),t.__group=a}function P(t,n){const o=n.__group;o&&[...o.children].forEach((t,n)=>{t.classList.remove("jit"),setTimeout(()=>{t.classList.add("hop-out"),t.onanimationend=()=>{t.remove(),0===o.childElementCount&&(o.remove(),x.delete(o))}},n*e.timing.hopOutDelay)})}const D=/^[A-Za-z0-9_-]{6}$/;function V(e){if(!e)return[];try{const t=JSON.parse(e);if(Array.isArray(t))return t.map(String);if(t&&"object"==typeof t)return Object.keys(t).filter(e=>t[e]).map(String)}catch{return"string"==typeof e?e.split(/[,\s]+/).map(e=>e.trim()).filter(Boolean):[]}return[]}const q=e=>{if(!e)return"";let t=String(e).split("?")[0].replace(/^\.?\//,"");try{t=decodeURIComponent(t)}catch{}return t};function R(t){try{const n=localStorage.getItem(e.storage.favorites);if(!(e=>{const t=V(e);return t.length>0&&!t.every(e=>D.test(e))})(n))return void localStorage.setItem(e.storage.favoritesVersion,"2");const o=V(n),{exact:a,lower:s}=function(e){const t=new Map,n=new Map;for(const o of e){const e=q(o.file),a=e.split("/").pop(),s=o.id||a;[e,a,`sounds/${e}`,`sounds/${a}`].forEach(e=>{t.set(e,s),n.set(e.toLowerCase(),s)})}return{exact:t,lower:n}}(t),i=[],r=new Set,d=[];o.forEach(e=>{const t=q(e),n=t.split("/").pop(),o=[t,t.replace(/^sounds\//,""),n,"sounds/"+t,"sounds/"+n].map(e=>a.get(e)||s.get(e.toLowerCase())).find(Boolean);o?r.has(o)||(r.add(o),i.push(o)):d.push(e)}),localStorage.setItem(e.storage.favoritesBackup,n),localStorage.setItem(e.storage.favorites,JSON.stringify(i)),localStorage.setItem(e.storage.favoritesVersion,"2"),l.favorites=i,l.favSet=new Set(i),S(`å·²å‡ç´šæœ€æ„›æ ¼å¼ï¼Œå…± ${i.length} ç­†${d.length?`ï¼›æœªåŒ¹é… ${d.length} ç­†`:""}ã€‚`),console.info("[favorites migration] done:",{converted:i.length,missing:d})}catch(e){console.warn("[favorites migration] error:",e)}}function A(){const{terms:e,tags:t}=u.parseQuery(),n=l.sounds.filter(n=>u.match(n,e,t)),o=l.receivedList.map(e=>l.soundMap.get(e)).filter(Boolean),a=new Set(n.map(e=>e.id)),i=l.favorites.map(e=>l.soundMap.get(e)).filter(e=>e&&a.has(e.id)),r=o.filter(e=>a.has(e.id)&&!l.favSet.has(e.id)),d=n.filter(e=>!l.favSet.has(e.id)&&!r.includes(e));l.isSorting||N(s.favGrid,i,{inFav:!0}),N(s.receivedGrid,r),l.displayList=d,l.renderedCount=0,s.grid.innerHTML="",l.observer?l.observer.disconnect():l.observer=new IntersectionObserver(e=>{e[0].isIntersecting&&F()},{rootMargin:"400px"}),F(),s.favEmpty.classList.toggle("hidden",i.length>0),s.empty.classList.toggle("hidden",n.length>0),s.receivedSection?.classList.toggle("hidden",0===r.length),function(){s.activeChips.innerHTML="";for(const e of l.queryTags){const t=l.tags[e],n=t?.color||"#94a3b8",o=c.el("span",{class:"chip",style:{background:n},onclick:()=>{l.queryTags.delete(e),A(),g(!0)}},[`#${t?.name||e}`,c.el("button",{title:"ç§»é™¤",onclick:()=>{l.queryTags.delete(e),A(),g(!0)}},"Ã—")]);s.activeChips.appendChild(o)}}()}function F(){const{displayList:t,renderedCount:n}=l;if(n>=t.length)return;const o=t.slice(n,n+e.ui.batchSize);if(0===o.length)return;const a=document.getElementById("grid-sentinel");a&&a.remove();const i=document.createDocumentFragment();for(const e of o)i.appendChild(O(e));if(s.grid.appendChild(i),l.renderedCount+=o.length,l.renderedCount<t.length){const e=c.el("div",{id:"grid-sentinel",style:{gridColumn:"1 / -1",height:"20px",pointerEvents:"none"}});s.grid.appendChild(e),l.observer.observe(e)}}function N(e,t,n={inFav:!1}){e.innerHTML="";for(const o of t)e.appendChild(O(o,n))}function O(n,o={inFav:!1}){const a=!(l.isSorting&&o.inFav),s={class:"heart","aria-pressed":String(u.inFav(n.id)),"aria-label":"åŠ å…¥/ç§»é™¤æœ€æ„›",...!a&&{disabled:"true","aria-disabled":"true",title:"æ­£åœ¨ç·¨è¼¯æœ€æ„›æ’åºï¼Œç„¡æ³•è®Šæ›´æœ€æ„›"}},i=c.el("button",s,c.svgHeart());a&&(i.onclick=e=>{e.stopPropagation(),function(e,n){if(l.isSorting)return void S(t.sortingBlocked);l.favSet.has(e)?l.favorites=l.favorites.filter(t=>t!==e):l.favorites.push(e);l.favSet=new Set(l.favorites),u.saveFav(),n&&n.setAttribute("aria-pressed",String(l.favSet.has(e)));A()}(n.id,i)});const r=c.el("div",{class:"tags"});for(const e of n.tags){const t=u.slug(e),n=l.tags[t]?.color||"#94a3b8",o=c.el("span",{class:"tag",style:{background:n}},e);o.addEventListener("click",e=>{e.stopPropagation(),j(t)}),r.appendChild(o)}const m=c.el("div",{id:"snd-"+n.id,"data-id":n.id,class:"sound",role:"button",tabindex:"0","aria-label":`æ’­æ”¾éŸ³æ•ˆï¼š${n.title}`},[c.el("div",{class:"sound-top"},[c.el("div",{class:"title",title:n.title},n.title),i]),r]),g=()=>{try{d(n)}catch(e){console.error(e)}},h=()=>clearTimeout(l.contextTimer);return a&&(m.addEventListener("click",g),m.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),g())}),m.addEventListener("contextmenu",e=>{e.preventDefault(),k(),L(n,e.clientX,e.clientY)}),m.addEventListener("pointerdown",t=>{clearTimeout(l.contextTimer);const{clientX:o,clientY:a}=t;l.contextTimer=setTimeout(()=>{k(),L(n,o||window.innerWidth/2,a||window.innerHeight/2)},e.timing.longPressDelay)}),m.addEventListener("pointerup",h),m.addEventListener("pointerleave",h)),m.addEventListener("pointercancel",h),m}function j(e){l.queryTags.add(e),A(),g(!0)}function H(){setTimeout(()=>{const e=new Audio("assets/confetti-pop.mp3");e.volume=.6,e.play().catch(e=>console.warn("Confetti sound failed",e))},10);const e=document.createElement("canvas");e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.pointerEvents="none",e.style.zIndex="9999",document.body.appendChild(e);const t=e.getContext("2d");e.width=window.innerWidth,e.height=window.innerHeight;const n=[],o=["#ffc0ab","#ff893d","#ffde82","#b2f4c7","#60cfff","#2d7eff","#b5b1ff"];[{x:0,y:0},{x:e.width,y:0},{x:0,y:e.height},{x:e.width,y:e.height}].forEach(t=>{for(let a=0;a<80;a++){const a=Math.atan2(e.height/2-t.y,e.width/2-t.x),s=1.8*(Math.random()-.5),l=10*Math.random()+6;n.push({x:t.x,y:t.y,vx:Math.cos(a+s)*l,vy:Math.sin(a+s)*l,color:o[Math.floor(Math.random()*o.length)],size:8*Math.random()+4,life:2,decay:.01*Math.random()+.005,rotation:360*Math.random(),rotationSpeed:6*(Math.random()-.5)})}}),function o(){t.clearRect(0,0,e.width,e.height);let a=!1;n.forEach(e=>{e.life>0&&(a=!0,e.x+=e.vx,e.y+=e.vy,e.vy+=.12,e.vx*=.95,e.vy*=.95,e.life-=e.decay,e.rotation+=e.rotationSpeed,t.save(),t.translate(e.x,e.y),t.rotate(e.rotation*Math.PI/180),t.fillStyle=e.color,t.globalAlpha=Math.max(0,e.life),t.fillRect(-e.size/2,-e.size/2,e.size,e.size),t.restore())}),a?requestAnimationFrame(o):document.body.removeChild(e)}()}function z(){const n=document.getElementById("anniversaryZone");n&&n.addEventListener("click",H);s.q.addEventListener("input",u.debounce(()=>{l.queryText=s.q.value,A(),g(!1)},e.timing.searchDebounce)),s.clearBtn.addEventListener("click",()=>{s.q.value="",l.queryText="",l.queryTags.clear(),A(),g(!0)}),s.navTabs.forEach(e=>{e.addEventListener("click",()=>{y(e.getAttribute("data-page")||"home")})}),s.navToggle&&s.navToggle.addEventListener("click",()=>{const e=!document.body.classList.contains("nav-open");document.body.classList.toggle("nav-open",e),s.navToggle.setAttribute("aria-expanded",String(e))});const o=()=>{document.body.classList.remove("nav-open"),s.navToggle?.setAttribute("aria-expanded","false")};document.addEventListener("click",e=>{if(!document.body.classList.contains("nav-open"))return;const t=document.querySelector("header");t&&!t.contains(e.target)&&o()}),s.navTabs.forEach(e=>e.addEventListener("click",o)),s.shuffleBtn&&s.shuffleBtn.addEventListener("click",()=>{const e=[],t=[];l.sounds.forEach((n,o)=>{l.favSet.has(n.id)||(e.push(n),t.push(o))}),a(e),t.forEach((t,n)=>{l.sounds[t]=e[n]}),A()}),s.resetOrderBtn&&s.resetOrderBtn.addEventListener("click",()=>{if(!l.defaultSoundsSnapshot||!l.defaultSoundsSnapshot.length)return;const e=l.defaultSoundsSnapshot,t=new Map(e.map((e,t)=>[e.id,t]));l.sounds.sort((e,n)=>(t.get(e.id)??1/0)-(t.get(n.id)??1/0)),A()}),s.sortFavBtn&&s.doneSortBtn&&(s.sortFavBtn.addEventListener("click",()=>{l.isSorting=!0,document.body.classList.add("sorting"),s.sortFavBtn.classList.add("hidden"),s.doneSortBtn.classList.remove("hidden");const{terms:e,tags:t}=u.parseQuery(),n=new Set(l.sounds.filter(n=>u.match(n,e,t)).map(e=>e.id)),o=l.favorites.map(e=>l.soundMap.get(e)).filter(e=>e&&n.has(e.id));N(s.favGrid,o,{inFav:!0}),"undefined"!=typeof Sortable?l.sortable=Sortable.create(s.favGrid,{dataIdAttr:"data-id",animation:150,delay:150,delayOnTouchOnly:!0,ghostClass:"drag-ghost",chosenClass:"drag-chosen",dragClass:"dragging",filter:".heart",preventOnFilter:!1}):console.warn("SortableJS æœªè¼‰å…¥")}),s.doneSortBtn.addEventListener("click",()=>{const e=[...s.favGrid.children].map(e=>e.dataset.id).filter(Boolean);e.length&&(l.favorites=e.concat(l.favorites.filter(t=>!e.includes(t))),l.favSet=new Set(l.favorites),u.saveFav(),S(t.sortingSaved)),l.sortable?.destroy(),l.sortable=null,l.isSorting=!1,document.body.classList.remove("sorting"),s.doneSortBtn.classList.add("hidden"),s.sortFavBtn.classList.remove("hidden"),A()})),s.shareFavBtn&&s.shareFavBtn.addEventListener("click",async()=>{const e=[...l.favorites];if(0===e.length)return void S(t.noFavorites);const n=function(e){const t=m();e?.length?t.set("list",e.join(",")):t.delete("list"),t.delete("sound");const n=t.toString();return`${location.origin}${location.pathname}${n?"?"+n:""}`}(e);await b(n),S(t.listLinkCopied)})}function W(){const s=document.getElementById("concentration-game"),d=document.getElementById("cg-board"),m=document.getElementById("cg-timer"),g=document.getElementById("cg-accuracy"),h=document.getElementById("cg-result"),f=document.getElementById("cg-restart");if(!s)return;let p=[],v=null,b=null,E=0,L=0,w=0,k=0,T=0,I=null,$=!1,C=!0,B=[],x=null,M=null,P=!1;function D(){const t=l.tagList.filter(e=>"streamer"===e.role).map(e=>u.slug(e.key)),n=e=>t.includes(e);let o=l.sounds.filter(e=>1===e.tags.filter(n).length&&(!e.tags.includes("é«’è©±")&&!e.tags.includes("SUS")));o=a(o);let s=function(t){const n={"é˜¿è¬":2,"ç“¦å“ˆ":1,Matsuko:1,"è±¹å­é ­":1,"è²“ä¸‹å»":1},o=new Set(Object.keys(n)),a=Object.fromEntries(Object.keys(n).map(e=>[e,0]));let s=0;const l=[];for(const i of t){if(l.length>=e.game.pairCount)break;const t=i.tags??[],r=t.find(e=>o.has(e)&&a[e]<n[e]);r?(a[r]++,l.push(i)):!t.some(e=>o.has(e))&&s<2&&(s++,l.push(i))}return l}(o);return s=a(s),s.splice(e.game.pairCount),s.map(e=>{const t=e.tags.find(n),o=l.tags[u.slug(t)];return{id:e.id,audio:e.src,streamer:t,avatar:o?.avatar||"",streamerName:o?.name||t,title:e.title}})}function V(){if(B=D(),!B?.length)return h.innerHTML=`<h3>ç„¡æ³•é–‹å§‹éŠæˆ²</h3><p style="color:var(--muted)">${n.gameNoSounds}</p>`,h.classList.remove("hidden"),void($=l.cgRunning=!1);[p,x,M]=[[],(clearTimeout(x),null),null];for(const e of B){const t={type:"card",pairId:e.id,audio:e.audio,avatar:e.avatar,streamer:e.streamer,streamerName:e.streamerName,title:e.title,matched:!1,seen:!1};p.push({...t,id:`${e.id}-0`},{...t,id:`${e.id}-1`})}a(p),[w,E,L,k,T,v,b]=[0,0,0,0,0,null,null],C=!0,P=$=l.cgRunning=!1,m&&(m.textContent=j(0),m.classList.remove("cg-running")),q(),O(),h.classList.add("hidden"),i=()=>{$=!1,l.cgRunning=!1,H(),A(),m?.classList.remove("cg-running"),d.innerHTML="",clearTimeout(x),x=M=null}}function q(){d.innerHTML="";for(const[e,t]of p.entries()){const n=c.el("div",{class:`cg-card${t.flipped||t.matched?" flipped":""}${t.matched?" matched":""}`,"data-idx":e,onclick:()=>F(e),onpointerdown:()=>{n.classList.add("clicked"),setTimeout(()=>n.classList.remove("clicked"),160)}}),a=t.avatar?`<img src="${o(t.avatar)}" alt="${t.streamerName}">`:`<div style="font-weight:700;color:var(--muted);font-size:12px">${t.streamerName}</div>`;n.innerHTML=`<div class="cg-card-inner"><div class="cg-card-front"></div><div class="cg-card-back">${a}${t.matched?'<div class="cg-lock">âœ“</div>':""}</div></div>`,d.appendChild(n)}}let R=null;const A=()=>{if(R){try{R.pause(),R.currentTime=0}catch(e){}R=null}};function F(t){if(M?.f||M?.s){clearTimeout(x),x=null;const e=M;M=null,N(e.f,e.s),v=b=null,C=!0}if(!C)return;const n=p[t];if(!n.flipped&&!n.matched){if(P||(P=$=l.cgRunning=!0,m?.classList.add("cg-running"),clearInterval(I),I=setInterval(()=>{l.cgRunning&&(T++,m.textContent=j(T))},1e3)),n.flipped=!0,q(),v){if(!b){n._seenBefore=!!n.seen,n.seen=!0,b=n,A(),R=r(n.audio,{preload:"auto"}),n.title&&S(n.title,3e3),k++,C=!1;M={f:v,s:b},x&&(clearTimeout(x),x=null),x=setTimeout(()=>{x=null;const e=M;M=null,N(e.f,e.s),v=null,b=null,C=!0},e.game.cardFlipDelay)}}else n._seenBefore=!!n.seen,n.seen=!0,v=n,A(),R=r(n.audio,{preload:"auto"}),n.title&&S(n.title,3e3);O()}}function N(n,o){if(n&&o){if(n.pairId===o.pairId)n.matched=o.matched=!0,E+=2,w++;else{const e=[n,o].filter(e=>e._seenBefore).length;L+=e||0,n.flipped=o.flipped=!1}delete n._seenBefore,delete o._seenBefore,q(),O(),w===B.length&&(A(),function(){$=l.cgRunning=!1,H(),A(),m?.classList.remove("cg-running");const n=E+L,o=n?Math.round(E/n*100):"--",a=(e,t)=>`<div><div class="big-num">${e}</div><div class="muted">${t}</div></div>`,s=[[j(T),"ç”¨æ™‚"],[E,"æ­£ç¢ºæ•¸"],[L,"éŒ¯è§£æ•¸"],[o+"%","æº–ç¢ºç‡"]].map(([e,t])=>a(e,t)).join("");if(h.innerHTML=`<h3>å®Œæˆï¼</h3>\n                                  <div class="stats">${s}</div>\n                                  <div style="display:flex;gap:8px;justify-content:center;margin-top:12px">\n                                    <button class="btn small-btn" id="cg-restart-2">å†ä¾†ä¸€å±€</button>\n                                    <button class="btn small-btn" id="cg-home">å›ä¸»é </button>\n                                  </div>`,h.classList.remove("hidden"),o>=e.game.rewardAccuracy){const n=l.soundMap.get(e.game.rewardSoundIds[Math.floor(Math.random()*e.game.rewardSoundIds.length)]);n?.src&&(A(),R=r(n.src,{preload:"auto"}),S(t.gameReward,3e3))}u.byId("cg-restart-2")?.addEventListener("click",V),u.byId("cg-home")?.addEventListener("click",()=>y("home"))}())}}function O(){m.textContent=j(T);const e=E+L;g.textContent=e?`æº–ç¢ºç‡ï¼š${Math.round(E/e*100)}%`:"æº–ç¢ºç‡ï¼š--%"}const j=e=>`${String(Math.floor(e/60)).padStart(2,"0")}:${String(e%60).padStart(2,"0")}`;const H=()=>{clearInterval(I),I=null};f.onclick=V,V()}(async function(){const[t,n]=await Promise.all([fetch(o(e.paths.tags),{cache:"no-store"}).then(e=>e.json()),fetch(o(e.paths.sounds),{cache:"no-store"}).then(e=>e.json())]);R(n),l.tags={},l.tagList=t.map(e=>({key:u.slug(e.key),name:e.name,color:e.color,role:e.role,avatar:e.avatar})),l.tagList.forEach(e=>{l.tags[e.key]=e}),l.sounds=n.map(e=>({id:e.id||e.file.replace(/^.*[\\\/]/,""),src:o(`sounds/${e.file}`),file:e.file,title:e.title,tags:e.tags.slice()})),l.soundMap=new Map(l.sounds.map(e=>[e.id,e])),l.defaultSoundsSnapshot=l.sounds.map(e=>({...e})),await async function(){try{const t=await fetch(o(e.paths.voteResults),{cache:"no-store"});if(!t.ok)return console.warn("[vote load] resp not ok",t.status),!1;const n=(await t.json()).slice(0,e.awards.topRankCount).map(e=>e.id).filter(Boolean);if(!n.length)return!1;const a=new Set,s=n.map(e=>l.soundMap.get(e)).filter(e=>e&&!a.has(e.id)&&(a.add(e.id),!0));return l.sounds=[...s,...l.sounds.filter(e=>!a.has(e.id))],l.soundMap=new Map(l.sounds.map(e=>[e.id,e])),l.defaultSoundsSnapshot=l.sounds.map(e=>({...e})),l.voteResults={matchedList:s,top10:s.slice(0,e.awards.top10Count),next20:s.slice(e.awards.top10Count,e.awards.topRankCount)},console.info("[vote reorder] applied ordering, matched:",s.length,"/",n.length),!0}catch(e){return console.warn("[vote load] failed",e),!1}}();const a=new Set;l.sounds.forEach(e=>e.tags.forEach(e=>a.add(u.slug(e)))),l.usedTagList=l.tagList.filter(e=>a.has(e.key))})().then(()=>{!function(){let e=0;setInterval(()=>{e-=75,document.body.style.setProperty("--bg-x",`${e}px`)},12e3)}(),fetch("assets/confetti-pop.mp3").catch(()=>{}),h(),function(){const e=s.tagList;e&&(e.innerHTML="",l.usedTagList.forEach(t=>{const n=c.el("span",{class:"tag",style:{background:t.color||"#94a3b8"}},t.name);n.addEventListener("click",()=>j(t.key)),e.appendChild(n)}))}(),y(l.page),A(),f(),z();try{const e=document.querySelector("header h1");e&&e.addEventListener("click",e=>{if(!(e.metaKey||e.ctrlKey||e.shiftKey||e.altKey)){if("home"===l.page)return location.reload();e.preventDefault(),l.queryText="",l.queryTags.clear(),s.q&&(s.q.value=""),y("home"),A(),g(!0);try{window.scrollTo({top:0,behavior:"smooth"})}catch{window.scrollTo(0,0)}}})}catch(e){console.warn("[resetOrderBtn] é‡ç½®æ’åºå¤±æ•—",e)}}).catch(e=>{console.error(e),s.grid.innerHTML=`<div class="empty">${n.configLoadFailed}</div>`}),document.addEventListener("pageChange",({detail:{page:e,prevPage:t,phase:n}={}})=>{try{"before"===n&&"game"===t&&i?.(),"after"===n&&("game"===e&&W?.(),"awards"===e&&function(){if(!l.voteResults)return s.awardsTop10?.replaceChildren(),void s.awardsNext20?.replaceChildren();s.awardsTop10&&N(s.awardsTop10,l.voteResults.top10??[]),s.awardsNext20&&N(s.awardsNext20,l.voteResults.next20??[])}())}catch(e){console.warn("[pageChange] é é¢åˆ‡æ›è™•ç†å¤±æ•—",e)}});const _=(()=>{const e="demaPanel_v1",t=32;let n=!1,o=!1,a=0,i=200,r=30,m=[],g=null,h=[],f=[],p=null,v=[],y=0,b=0,E=null,L=null,T=null;const I=new Map,$=new Map,C=(e,t,n)=>Math.max(t,Math.min(n,e)),B=e=>{const t=Math.floor(e/60),n=Math.floor(e%60),o=Math.floor(e%1*100);return`${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}.${String(o).padStart(2,"0")}`},x=()=>{try{const t={version:1,playheadTime:a,pxPerSec:i,clips:m.map(e=>({...e})),undoStack:h.slice(-50),redoStack:f.slice(-50)};localStorage.setItem(e,JSON.stringify(t))}catch(e){console.warn("[demaPanel] save failed",e)}},M=()=>{h.push(JSON.stringify(m)),h.length>50&&h.shift(),f=[],V()},P=()=>{h.length&&(f.push(JSON.stringify(m)),m=JSON.parse(h.pop()),g=null,V(),Y(),x())},D=()=>{f.length&&(h.push(JSON.stringify(m)),m=JSON.parse(f.pop()),g=null,V(),Y(),x())},V=()=>{s.demaUndo&&(s.demaUndo.disabled=!h.length),s.demaRedo&&(s.demaRedo.disabled=!f.length)},q=()=>(p||(p=new(window.AudioContext||window.webkitAudioContext)),"suspended"===p.state&&p.resume(),p),R=async e=>{if(I.has(e))return I.get(e);const t=q(),n=await fetch(e),o=await n.arrayBuffer(),a=await t.decodeAudioData(o);return I.set(e,a),A(e,a),a},A=(e,t)=>{if($.has(e))return;const n=t.getChannelData(0),o=t.duration,a=Math.ceil(120*o),s=Math.floor(n.length/a),l=[];for(let e=0;e<a;e++){let t=0;const o=e*s;for(let e=0;e<s;e++)t+=Math.abs(n[o+e]||0);l.push(t/s)}const i=Math.max(...l,.01),r=l.map(e=>e/i);$.set(e,{data:r,duration:o})},F=(e,t,n,o,a)=>{const s=$.get(t);if(!s||!e)return;const{data:l,duration:i}=s,r=e.getContext("2d"),d=e.width,c=e.height,u=c/2;r.clearRect(0,0,d,c),r.fillStyle="rgba(255, 255, 255, 0.85)";const m=n/i,g=1-o/i,h=Math.floor(m*l.length),f=Math.ceil(g*l.length)-h;if(f<=0)return;const p=d/f;for(let e=0;e<f;e++){const t=h+e;if(t>=l.length)break;const n=e*p,o=l[t]*c*.85;r.fillRect(n,u-o/2,Math.max(1,p-.5),o)}},N=async()=>{if(o)return;if(0===m.length)return;const e=q();o=!0,y=e.currentTime,b=a,v=[];const t=G();a>=t&&(a=0,b=0);for(const t of m){const n=l.soundMap.get(t.soundId);if(n)try{const o=await R(n.src),s=e.createBufferSource();s.buffer=o;const i=e.createGain(),r=t.volume??1;i.gain.value=(l.globalVolume??1)*r,s.connect(i),i.connect(e.destination);const d=t.startTime,c=t.duration-t.trimStart-t.trimEnd,u=d+c;if(a>=u)continue;let m=t.trimStart,g=0,h=c;a>d?(m+=a-d,h=u-a):g=d-a,h>0&&(s.start(e.currentTime+g,m,h),v.push({source:s,gainNode:i}))}catch(e){console.warn("[demaPanel] failed to play clip",t.id,e)}}z(),W()},O=()=>{if(o){o=!1;for(const{source:e}of v)try{e.stop()}catch{}v=[],p&&(a=b+(p.currentTime-y)),_(),z(),J(),x()}},j=()=>{const e=o;o&&O();let n=0;const l=m.filter(e=>e.startTime<=a&&e.startTime+e.duration>a);if(l.length>0)l.sort((e,t)=>e.startTime-t.startTime),n=l[0].startTime;else{const e=m.filter(e=>e.startTime<a);e.length>0?(e.sort((e,t)=>t.startTime-e.startTime),n=e[0].startTime):n=0}a=n,J(),K();const r=s.demaTracksScroll?.parentElement;if(r){const e=a*i+t-r.clientWidth/2;r.scrollLeft=Math.max(0,e)}e&&N()},H=()=>{const e=o;o&&O();let n=r;const l=m.filter(e=>e.startTime>a+.01);if(l.length>0)l.sort((e,t)=>e.startTime-t.startTime),n=l[0].startTime;else if(m.length>0){let e=0;for(const t of m){const n=t.duration-t.trimStart-t.trimEnd,o=t.startTime+n;o>e&&(e=o)}n=e}else n=r;a=n,J(),K();const d=s.demaTracksScroll?.parentElement;if(d){const e=a*i+t-d.clientWidth/2;d.scrollLeft=Math.max(0,e)}e&&N()},z=()=>{s.demaPlayIcon&&(s.demaPlayIcon.style.display=o?"none":"block"),s.demaPauseIcon&&(s.demaPauseIcon.style.display=o?"block":"none"),s.demaPlayPause&&(s.demaPlayPause.style.background=o?"var(--accent-2)":"var(--accent)",s.demaPlayPause.style.borderColor=o?"var(--accent-2)":"var(--accent)")},W=()=>{const e=()=>{if(!o)return;const t=q();a=b+(t.currentTime-y);const n=G();if(a>=n)return a=n,void O();J(),K(),E=requestAnimationFrame(e)};E=requestAnimationFrame(e)},_=()=>{E&&(cancelAnimationFrame(E),E=null)},G=()=>{if(0===m.length)return 30;let e=0;for(const t of m){const n=t.startTime+(t.duration-t.trimStart-t.trimEnd);n>e&&(e=n)}return Math.max(30,Math.ceil(e)+5)},J=()=>{if(!s.demaPlayhead)return;const e=t+a*i;s.demaPlayhead.style.left=e+"px"},K=()=>{s.demaTime&&(r=G(),s.demaTime.textContent=`${B(a)} / ${B(r)}`)};let U=!1;const Y=()=>{if(U)X();else{s.demaTrackContents.forEach(e=>e.innerHTML=""),s.demaEmpty&&(s.demaEmpty.style.display=0===m.length?"flex":"none");for(const e of m){const t=l.soundMap.get(e.soundId);if(!t)continue;const n=document.querySelector(`[data-track-content="${e.trackIndex}"]`);if(!n)continue;let o="#6aa9ff";for(const e of t.tags){const t=l.tags[u.slug(e)];if("streamer"===t?.role&&t.color){o=t.color;break}}const a=e.duration-e.trimStart-e.trimEnd,s=Math.max(20,a*i),r=e.startTime*i+2,d=document.createElement("canvas");d.width=Math.max(20,Math.floor(s)),d.height=26,d.className="dema-clip-wave-canvas";const m=c.el("div",{class:"dema-clip"+(e.id===g?" selected":""),"data-clip-id":e.id,style:{left:r+"px",width:s+"px",background:o}},[c.el("div",{class:"dema-clip-wave"},[d]),c.el("div",{class:"dema-clip-label"},t.title),c.el("div",{class:"dema-clip-handle dema-clip-handle--left"}),c.el("div",{class:"dema-clip-handle dema-clip-handle--right"})]);$.has(t.src)?F(d,t.src,e.trimStart,e.trimEnd,e.duration):R(t.src).then(()=>{F(d,t.src,e.trimStart,e.trimEnd,e.duration)}).catch(e=>{console.warn("[demaPanel] ç„¡æ³•è¼‰å…¥éŸ³è¨Šæ³¢å‹",t.src,e)}),m.addEventListener("pointerdown",t=>oe(t,e)),m.addEventListener("dblclick",t=>le(t,e)),n.appendChild(m)}ee(),K(),Z(),Q()}},X=()=>{for(const e of m){const t=document.querySelector(`[data-clip-id="${e.id}"]`);if(!t)continue;const n=e.duration-e.trimStart-e.trimEnd,o=Math.max(20,n*i),a=e.startTime*i+2;t.style.left=a+"px",t.style.width=o+"px",t.classList.toggle("selected",e.id===g);const s=t.closest("[data-track-content]"),r=document.querySelector(`[data-track-content="${e.trackIndex}"]`);s&&r&&s!==r&&r.appendChild(t);const d=t.querySelector(".dema-clip-wave-canvas");if(d){const t=l.soundMap.get(e.soundId);t&&(d.width=Math.max(20,Math.floor(o)),F(d,t.src,e.trimStart,e.trimEnd,e.duration))}}K()},Z=()=>{s.demaRemoveSelected&&(s.demaRemoveSelected.disabled=!g)},Q=()=>{if(!s.demaClipVolumeWrap)return;if(!g)return void(s.demaClipVolumeWrap.style.display="none");const e=m.find(e=>e.id===g);if(!e)return void(s.demaClipVolumeWrap.style.display="none");s.demaClipVolumeWrap.style.display="flex";const t=Math.round(100*(e.volume??1));s.demaClipVolume.value=t,s.demaClipVolumeValue.textContent=t+"%"},ee=()=>{r=G();const e=r*i+t;s.demaTracksScroll&&(s.demaTracksScroll.style.minWidth=e+"px"),(()=>{const e=s.demaTimelineCanvas;if(!e)return;const n=e.parentElement,o=r*i+t,a=n?.clientHeight||25,l=window.devicePixelRatio||1;e.width=o*l,e.height=a*l,e.style.width=o+"px",e.style.height=a+"px";const d=e.getContext("2d");d.scale(l,l),d.clearRect(0,0,o,a);const c=getComputedStyle(document.documentElement),u=c.getPropertyValue("--fg").trim()||"#e9eef5",m=c.getPropertyValue("--muted").trim()||"#a8b3c7";d.font="10px ui-sans-serif, system-ui, sans-serif",d.textBaseline="middle";let g=1;g=i<80?5:i<150?2:i<300?1:i<500?.5:.25;const h=a/2;for(let e=0;e<=r;e+=g){const n=t+e*i;if(d.fillStyle=m,d.fillRect(n,a-6,1,6),e%(g<1?1:g)===0||g>=1){const t=B(e).slice(0,5);d.fillStyle=u,d.fillText(t,n+3,h)}}})()},te=e=>{const t=m.findIndex(t=>t.id===e);-1!==t&&(M(),m.splice(t,1),g===e&&(g=null),Y(),x())},ne=()=>{if(0===m.length&&0===h.length&&0===f.length)return;const e=document.createElement("div");e.className="modal-backdrop",e.setAttribute("role","dialog"),e.setAttribute("aria-modal","true");const t=document.createElement("div");t.className="modal",t.innerHTML='\n              <p style="margin: 0 0 var(--space-sm); font-size: 14px;">ç¢ºå®šè¦é‡ç½®æ‰€æœ‰éŸ³è»Œå—ï¼Ÿ</p>\n              <p style="margin: 0 0 var(--space-sm); font-size: 12px; color: var(--muted);">é€™å°‡æ¸…ç©ºæ‰€æœ‰ç‰‡æ®µå’Œæ­¥é©Ÿç´€éŒ„ã€‚</p>\n              <div class="modal-actions">\n                <button class="btn" data-action="cancel">å–æ¶ˆ</button>\n                <button class="btn" data-action="confirm">ç¢ºå®šé‡ç½®</button>\n              </div>\n            ',e.appendChild(t),document.body.appendChild(e),t.querySelector('[data-action="cancel"]').focus();const n=()=>e.remove();e.addEventListener("click",t=>{t.target===e&&n()}),t.querySelector('[data-action="cancel"]').addEventListener("click",n),t.querySelector('[data-action="confirm"]').addEventListener("click",()=>{n(),m=[],g=null,h=[],f=[],a=0,Y(),J(),V(),x(),S("å·²é‡ç½®æ‰€æœ‰éŸ³è»Œ")});const o=e=>{"Escape"===e.key&&(n(),document.removeEventListener("keydown",o))};document.addEventListener("keydown",o)},oe=(e,t)=>{e.stopPropagation(),e.preventDefault();const n=e.target,o=n.classList.contains("dema-clip-handle--left"),a=n.classList.contains("dema-clip-handle--right");g=t.id,document.querySelectorAll(".dema-clip").forEach(e=>{e.classList.toggle("selected",e.dataset.clipId===t.id)}),Z(),Q();const s=e.currentTarget;s.getBoundingClientRect();let l="pending";o?l="trim-left":a&&(l="trim-right"),L={clipId:t.id,mode:l,startX:e.clientX,startY:e.clientY,initialStartTime:t.startTime,initialTrimStart:t.trimStart,initialTrimEnd:t.trimEnd,initialTrackIndex:t.trackIndex,moved:!1},"trim-left"===l||"trim-right"===l?(M(),U=!0,s.classList.add("dragging")):"touch"===e.pointerType?T=setTimeout(()=>{L&&"pending"===L.mode&&(M(),L.mode="move",U=!0,s.classList.add("dragging"))},200):(M(),L.mode="move",U=!0,s.classList.add("dragging")),s.setPointerCapture(e.pointerId),document.addEventListener("pointermove",ae),document.addEventListener("pointerup",se),document.addEventListener("pointercancel",se)},ae=e=>{if(!L)return;const t=e.clientX-L.startX,n=e.clientY-L.startY,o=m.find(e=>e.id===L.clipId);if(o){if(Math.abs(t)>3||Math.abs(n)>3){if(T&&(clearTimeout(T),T=null),"pending"===L.mode){L.mode="move",U=!0;const e=document.querySelector(`[data-clip-id="${o.id}"]`);e&&e.classList.add("dragging")}L.moved=!0}if("pending"!==L.mode)if("move"===L.mode){const n=t/i;o.startTime=Math.max(0,L.initialStartTime+n);const a=document.querySelectorAll(".dema-track");for(let t=0;t<a.length;t++){const n=a[t].getBoundingClientRect();if(e.clientY>=n.top&&e.clientY<=n.bottom){o.trackIndex=t;break}}X()}else if("trim-left"===L.mode){const e=t/i,n=Math.max(0,L.initialTrimStart-L.initialStartTime),a=C(L.initialTrimStart+e,n,o.duration-o.trimEnd-.1),s=a-L.initialTrimStart;o.trimStart=a,o.startTime=L.initialStartTime+s,X()}else if("trim-right"===L.mode){const e=t/i;o.trimEnd=C(L.initialTrimEnd-e,0,o.duration-o.trimStart-.1),X()}}},se=e=>{T&&(clearTimeout(T),T=null),document.removeEventListener("pointermove",ae),document.removeEventListener("pointerup",se),document.removeEventListener("pointercancel",se);try{const t=document.querySelector(`[data-clip-id="${L?.clipId}"]`);t&&e.pointerId&&t.releasePointerCapture(e.pointerId)}catch{}U=!1,L?.moved&&x(),document.querySelectorAll(".dema-clip.dragging").forEach(e=>e.classList.remove("dragging")),L=null,Y()},le=(e,t)=>{e.stopPropagation(),ie(t,e.clientX,e.clientY)},ie=(e,t,n)=>{const o=s.menu;if(!o)return;o.innerHTML="";const a=l.soundMap.get(e.soundId),i=c.el("div",{class:"menu-item",role:"menuitem"},"â–¶ï¸ è©¦è½");i.addEventListener("click",()=>{k(),a&&d(a)});const r=c.el("div",{class:"menu-item",role:"menuitem"},"ğŸ—‘ï¸ ç§»é™¤");r.addEventListener("click",()=>{k(),te(e.id)}),o.append(i,r),o.classList.remove("hidden"),requestAnimationFrame(()=>w(t,n))};let re=null;const de=e=>{if(e.target.closest(".dema-clip"))return;const t=s.demaTracksScroll?.parentElement;t&&(re={startX:e.clientX,startY:e.clientY,startScrollLeft:t.scrollLeft,moved:!1},t.classList.add("dragging"),t.setPointerCapture(e.pointerId))},ce=e=>{if(!re)return;const t=e.clientX-re.startX,n=e.clientY-re.startY;if((Math.abs(t)>3||Math.abs(n)>3)&&(re.moved=!0),re.moved){const e=s.demaTracksScroll?.parentElement;e&&(e.scrollLeft=re.startScrollLeft-t)}},ue=e=>{if(!re)return;const t=s.demaTracksScroll?.parentElement;if(t){t.classList.remove("dragging");try{t.releasePointerCapture(e.pointerId)}catch{}}re.moved||me(e),re=null},me=e=>{if(e.target.closest(".dema-clip"))return;g=null,Y();const n=s.demaTracksScroll?.parentElement;if(!n)return;const l=n.getBoundingClientRect(),d=n.scrollLeft,c=e.clientX-l.left+d-t;if(c>=0){const e=o;o&&O(),a=C(c/i,0,r),J(),K(),x(),e&&N()}},ge=()=>{n||(n=!0,s.demaPanel?.classList.add("open"),s.demaPanel?.setAttribute("aria-hidden","false"),document.body.classList.add("dema-open"),Y(),J(),K())},he=()=>{n&&(O(),n=!1,s.demaPanel?.classList.remove("open"),s.demaPanel?.setAttribute("aria-hidden","true"),document.body.classList.remove("dema-open"))},fe=()=>{(()=>{try{const t=localStorage.getItem(e);if(!t)return;const n=JSON.parse(t);if(1!==n.version)return;a=n.playheadTime||0,i=C(n.pxPerSec||200,50,800),m=(n.clips||[]).filter(e=>e&&e.id&&e.soundId),h=n.undoStack||[],f=n.redoStack||[]}catch(e){console.warn("[demaPanel] load failed",e)}})(),s.openDemaBtn?.addEventListener("click",ge),s.demaClose?.addEventListener("click",he),s.demaPlayPause?.addEventListener("click",()=>o?O():N()),s.demaSkipNext?.addEventListener("click",H),s.demaSkipBack?.addEventListener("click",j),s.demaUndo?.addEventListener("click",P),s.demaRedo?.addEventListener("click",D),s.demaClear?.addEventListener("click",ne),s.demaRemoveSelected?.addEventListener("click",()=>{g&&te(g)}),s.demaZoom?.addEventListener("input",e=>{(e=>{const n=s.demaTracksScroll?.parentElement;if(!n)return;const o=(n.scrollLeft+n.clientWidth/2-t)/i;i=C(e,50,800);const a=o*i+t-n.clientWidth/2;n.scrollLeft=Math.max(0,a),Y(),J(),x(),s.demaZoom&&(s.demaZoom.value=i)})(parseInt(e.target.value,10))}),s.demaZoom&&(s.demaZoom.value=i);let l=!1;s.demaClipVolume?.addEventListener("pointerdown",()=>{l=!1}),s.demaClipVolume?.addEventListener("input",e=>{if(!g)return;const t=m.find(e=>e.id===g);if(!t)return;l||(M(),l=!0);const n=parseInt(e.target.value,10);t.volume=n/100,s.demaClipVolumeValue.textContent=n+"%",x()});const r=s.demaTracksScroll?.parentElement;r&&(r.addEventListener("pointerdown",de),r.addEventListener("pointermove",ce),r.addEventListener("pointerup",ue),r.addEventListener("pointercancel",ue)),document.addEventListener("keydown",e=>{n&&(e.target.matches("input, textarea, [contenteditable]")||(" "===e.key?(e.preventDefault(),o?O():N()):"Delete"===e.key||"Backspace"===e.key?g&&(e.preventDefault(),te(g)):(e.ctrlKey||e.metaKey)&&("z"===e.key?(e.preventDefault(),e.shiftKey?D():P()):"y"===e.key&&(e.preventDefault(),D()))))}),V(),ee(),Y(),J(),K(),console.info("[demaPanel] initialized")};return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",fe):setTimeout(fe,0),{open:ge,close:he,toggle:()=>n?he():ge(),addSoundToTrack:async(e,t=0)=>{n||ge(),await(async(e,t=0,n=null)=>{let o=3;try{o=(await R(e.src)).duration}catch(e){console.warn("[demaPanel] failed to get duration",e)}const s={id:"clip-"+Math.random().toString(36).slice(2,10),soundId:e.id,trackIndex:C(t,0,2),startTime:n??a,trimStart:0,trimEnd:0,duration:o,volume:1};return M(),m.push(s),g=s.id,Y(),x(),s})(e,t)},play:N,pause:O,stop:()=>{O(),a=0,J(),K(),x()}}})(),G=(()=>{const e="1.0.0",t=e=>console.log(`%câ•â•â• ${e} â•â•â•`,"color: #6aa9ff; font-weight: bold; font-size: 14px;"),n=e=>console.log(`%câ–¸ ${e}`,"color: #ff9e6a; font-weight: bold;"),o=e=>console.log(`%câœ… ${e}`,"color: #4ade80;"),a=e=>console.log(`%câš ï¸ ${e}`,"color: #fbbf24;"),s=e=>console.log(`%câŒ ${e}`,"color: #f87171;"),i=e=>console.log(`%câ„¹ï¸ ${e}`,"color: #94a3b8;"),r=(e,t="   ")=>e.forEach(e=>console.log(`${t}â€¢ ${e}`)),d={checkFiles:(e={})=>{const{verbose:i=!1,concurrency:r=10}=e;t("ğŸ” æª”æ¡ˆå­˜åœ¨æ€§æ¸¬è©¦"),console.log(`   æ¸¬è©¦ ${l.sounds.length} å€‹éŸ³æ•ˆæª”æ¡ˆ...`),console.log(`   ä¸¦ç™¼æ•¸: ${r}`),console.log("");const d={ok:[],missing:[],error:[]};let c=0;const u=async e=>{try{const t=await fetch(e.src,{method:"HEAD"});t.ok?(d.ok.push(e),i&&o(`${e.file}`)):(d.missing.push({snd:e,status:t.status}),s(`${e.file} (HTTP ${t.status})`))}catch(t){d.error.push({snd:e,error:t.message}),s(`${e.file} (${t.message})`)}c++,c%100!=0&&c!==l.sounds.length||console.log(`   é€²åº¦: ${c}/${l.sounds.length}`)};return(async()=>{const e=[...l.sounds],t=[];for(let n=0;n<r;n++)t.push((async()=>{for(;e.length>0;){const t=e.shift();t&&await u(t)}})());await Promise.all(t),console.log(""),n("æ¸¬è©¦çµæœæ‘˜è¦"),o(`æ­£å¸¸: ${d.ok.length} ç­†`),d.missing.length>0&&(s(`ç¼ºå¤±: ${d.missing.length} ç­†`),d.missing.forEach(({snd:e,status:t})=>{console.log(`      â€¢ ${e.file} (HTTP ${t})`)})),d.error.length>0&&(a(`éŒ¯èª¤: ${d.error.length} ç­†`),d.error.forEach(({snd:e,error:t})=>{console.log(`      â€¢ ${e.file} (${t})`)})),console.log(""),console.log("ğŸ’¡ çµæœå·²å­˜å…¥: SoundboardDebug.lastTestResult"),window.SoundboardDebug.lastTestResult=d})(),"æ¸¬è©¦åŸ·è¡Œä¸­ï¼Œè«‹ç­‰å¾…çµæœ..."},checkTags:()=>{t("ğŸ·ï¸ æ¨™ç±¤å®Œæ•´æ€§æ¸¬è©¦");const e=new Set(l.tagList.map(e=>e.key)),n=[];if(l.sounds.forEach(t=>{t.tags.forEach(o=>{const a=u.slug(o);e.has(a)||n.push({sound:t.title,soundId:t.id,tag:o,tagKey:a})})}),0===n.length)o("æ‰€æœ‰æ¨™ç±¤åƒç…§éƒ½æœ‰æ•ˆ");else{s(`ç™¼ç¾ ${n.length} å€‹ç„¡æ•ˆæ¨™ç±¤åƒç…§:`);const e={};n.forEach(t=>{e[t.tagKey]||(e[t.tagKey]=[]),e[t.tagKey].push(t.sound)}),Object.entries(e).forEach(([e,t])=>{console.log(`   â€¢ "${e}" è¢« ${t.length} å€‹éŸ³æ•ˆä½¿ç”¨`),t.length<=5?t.forEach(e=>console.log(`      - ${e}`)):(t.slice(0,3).forEach(e=>console.log(`      - ${e}`)),console.log(`      ... é‚„æœ‰ ${t.length-3} å€‹`))})}return console.log(""),{valid:0===n.length,issues:n}},checkIds:()=>{t("ğŸ”‘ ID å”¯ä¸€æ€§æ¸¬è©¦");const e={};l.sounds.forEach(t=>{e[t.id]||(e[t.id]=[]),e[t.id].push(t)});const n=Object.entries(e).filter(([,e])=>e.length>1);return 0===n.length?o(`æ‰€æœ‰ ${l.sounds.length} å€‹éŸ³æ•ˆ ID éƒ½æ˜¯å”¯ä¸€çš„`):(s(`ç™¼ç¾ ${n.length} çµ„é‡è¤‡ ID:`),n.forEach(([e,t])=>{console.log(`   â€¢ ID "${e}" å‡ºç¾ ${t.length} æ¬¡:`),t.forEach(e=>console.log(`      - ${e.title} (${e.file})`))})),console.log(""),{valid:0===n.length,duplicates:n}},all:()=>{t("ğŸ§ª åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦"),console.log(""),d.checkIds(),d.checkTags(),console.log(""),i("æª”æ¡ˆå­˜åœ¨æ€§æ¸¬è©¦éœ€è¦ç¶²è·¯è«‹æ±‚ï¼Œè«‹åŸ·è¡Œ:"),console.log("   SoundboardDebug.test.checkFiles()"),console.log("")}},c={state:()=>(t("ğŸ“¦ æ‡‰ç”¨ç¨‹å¼ç‹€æ…‹ (state)"),console.log(l),l),sound:e=>{let n;return n="number"==typeof e?l.sounds[e]:l.soundMap.get(e),n?(t(`ğŸ”Š éŸ³æ•ˆè©³æƒ…: ${n.title}`),console.log("   ID:",n.id),console.log("   æª”æ¡ˆ:",n.file),console.log("   ä¾†æº:",n.src),console.log("   æ¨™ç±¤:",n.tags.join(", ")),console.log("   æ˜¯å¦æœ€æ„›:",l.favSet.has(n.id)?"æ˜¯":"å¦"),console.log(""),console.log("å®Œæ•´ç‰©ä»¶:"),console.log(n),n):(s(`æ‰¾ä¸åˆ°éŸ³æ•ˆ: ${e}`),null)},tag:e=>{const n=u.slug(e),o=l.tags[n];if(!o){s(`æ‰¾ä¸åˆ°æ¨™ç±¤å®šç¾©: ${e}`);const t=l.sounds.filter(e=>e.tags.some(e=>u.slug(e)===n));return t.length>0&&a(`ä½†æœ‰ ${t.length} å€‹éŸ³æ•ˆä½¿ç”¨æ­¤æ¨™ç±¤`),null}t(`ğŸ·ï¸ æ¨™ç±¤è©³æƒ…: ${o.name}`),console.log("   Key:",o.key),console.log("   åç¨±:",o.name),console.log("   é¡è‰²:",o.color),console.log("   è§’è‰²:",o.role),o.avatar&&console.log("   é ­åƒ:",o.avatar);const i=l.sounds.filter(e=>e.tags.some(e=>u.slug(e)===n));return console.log(`   ä½¿ç”¨æ­¤æ¨™ç±¤çš„éŸ³æ•ˆ: ${i.length} å€‹`),console.log(""),{definition:o,soundCount:i.length,sounds:i}},favorites:()=>{if(t("â¤ï¸ æœ€æ„›åˆ—è¡¨"),console.log(`   ç¸½æ•¸: ${l.favorites.length} ç­†`),console.log(""),0===l.favorites.length)return i("ç›®å‰æ²’æœ‰æœ€æ„›"),[];const e=l.favorites.map((e,t)=>{const n=l.soundMap.get(e);return n?(console.log(`   ${t+1}. ${n.title} (${e})`),{id:e,title:n.title,found:!0}):(a(`   ${t+1}. [æ‰¾ä¸åˆ°] (${e})`),{id:e,title:null,found:!1})}),n=e.filter(e=>!e.found);return n.length>0&&(console.log(""),a(`æœ‰ ${n.length} å€‹æœ€æ„› ID æ‰¾ä¸åˆ°å°æ‡‰éŸ³æ•ˆ`)),console.log(""),e},sounds:(e=1,n=20)=>{const o=(e-1)*n,a=o+n,s=Math.ceil(l.sounds.length/n);return t(`ğŸ“‹ éŸ³æ•ˆåˆ—è¡¨ (ç¬¬ ${e}/${s} é )`),console.log(`   é¡¯ç¤º ${o+1}-${Math.min(a,l.sounds.length)} / ${l.sounds.length}`),console.log(""),l.sounds.slice(o,a).forEach((e,t)=>{console.log(`   ${o+t+1}. ${e.title} [${e.id}]`)}),console.log(""),e<s&&console.log(`ğŸ’¡ æŸ¥çœ‹ä¸‹ä¸€é : SoundboardDebug.inspect.sounds(${e+1})`),l.sounds.slice(o,a)},tags:()=>{t("ğŸ·ï¸ æ¨™ç±¤åˆ—è¡¨"),console.log(`   ç¸½æ•¸: ${l.tagList.length} å€‹`),console.log("");const e=l.tagList.filter(e=>"streamer"===e.role),o=l.tagList.filter(e=>"category"===e.role),a=l.tagList.filter(e=>"streamer"!==e.role&&"category"!==e.role);return e.length>0&&(n("å¯¦æ³ä¸»"),e.forEach(e=>console.log(`   â€¢ ${e.name} (${e.key}) ${e.color}`))),o.length>0&&(n("åˆ†é¡"),o.forEach(e=>console.log(`   â€¢ ${e.name} (${e.key}) ${e.color}`))),a.length>0&&(n("å…¶ä»–"),a.forEach(e=>console.log(`   â€¢ ${e.name} (${e.key}) ${e.color}`))),console.log(""),l.tagList}};return setTimeout(()=>{console.log("%cğŸ›ï¸ SoundboardDebug å·²è¼‰å…¥ %câ€” è¼¸å…¥ %cSoundboardDebug.help()%c ç²å–ä½¿ç”¨æŒ‡å—","color: #6aa9ff; font-weight: bold;","color: #94a3b8;","color: #4ade80; font-weight: bold;","color: #94a3b8;")},100),{status:()=>{t("ğŸ“Š éŸ³æ•ˆæ¿ç‹€æ…‹å ±å‘Š"),n("éŸ³æ•ˆçµ±è¨ˆ"),console.log(`   è¼‰å…¥éŸ³æ•ˆæ•¸é‡: ${l.sounds.length} ç­†`),console.log(`   soundMap å¤§å°: ${l.soundMap.size} ç­†`),console.log(`   æœ€æ„›æ•¸é‡: ${l.favorites.length} ç­†`),console.log(`   ç›®å‰é¡¯ç¤ºåˆ—è¡¨: ${l.displayList.length} ç­†`),console.log(`   å·²æ¸²æŸ“æ•¸é‡: ${l.renderedCount} ç­†`),n("æ¨™ç±¤çµ±è¨ˆ"),console.log(`   tags.json å®šç¾©: ${l.tagList.length} å€‹`),console.log(`   å¯¦éš›è¢«ä½¿ç”¨: ${l.usedTagList.length} å€‹`);const e=new Set(l.tagList.map(e=>e.key)),d=new Set;l.sounds.forEach(e=>e.tags.forEach(e=>d.add(u.slug(e))));const c=[...d].filter(t=>!e.has(t));c.length>0?(a(`å­¤å…’æ¨™ç±¤ (éŸ³æ•ˆä½¿ç”¨ä½†æœªåœ¨ tags.json å®šç¾©): ${c.length} å€‹`),r(c)):o("ç„¡å­¤å…’æ¨™ç±¤");const m=l.tagList.filter(e=>!d.has(e.key)).map(e=>e.key);m.length>0&&(i(`æœªä½¿ç”¨æ¨™ç±¤ (å·²å®šç¾©ä½†ç„¡éŸ³æ•ˆä½¿ç”¨): ${m.length} å€‹`),r(m));const g={};l.sounds.forEach(e=>{g[e.id]=(g[e.id]||0)+1});const h=Object.entries(g).filter(([,e])=>e>1).map(([e,t])=>`${e} (${t}æ¬¡)`);return h.length>0?(s(`é‡è¤‡ ID: ${h.length} å€‹`),r(h)):o("ç„¡é‡è¤‡ ID"),n("å…¶ä»–ç‹€æ…‹"),console.log(`   ç›®å‰é é¢: ${l.page}`),console.log("   æ’åºæ¨¡å¼: "+(l.isSorting?"æ˜¯":"å¦")),console.log(`   å…¨åŸŸéŸ³é‡: ${Math.round(100*l.globalVolume)}%`),console.log(`   æ”¶åˆ°çš„åˆ†äº«åˆ—è¡¨: ${l.receivedList.length} ç­†`),console.log(""),{soundCount:l.sounds.length,orphanTags:c,unusedTags:m,duplicateIds:h}},test:d,inspect:c,help:()=>{console.log(`\n%câ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\nâ•‘          ğŸ›ï¸ SoundboardDebug æ§åˆ¶å°è¨ºæ–·å·¥å…· v${e}          â•‘\nâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•%c\n\n%cã€ç‹€æ…‹å ±å‘Šã€‘%c\n  SoundboardDebug.status()          é¡¯ç¤ºå®Œæ•´ç‹€æ…‹å ±å‘Šï¼ˆéŸ³æ•ˆæ•¸é‡ã€å­¤å…’æ¨™ç±¤ç­‰ï¼‰\n\n%cã€æ¸¬è©¦åŠŸèƒ½ã€‘%c\n  SoundboardDebug.test.checkFiles() æª¢æŸ¥æ‰€æœ‰éŸ³æ•ˆæª”æ¡ˆæ˜¯å¦å­˜åœ¨ï¼ˆéœ€ç­‰å¾…ï¼‰\n  SoundboardDebug.test.checkFiles({ verbose: true })  é¡¯ç¤ºæ¯å€‹æª”æ¡ˆçµæœ\n  SoundboardDebug.test.checkTags()  æª¢æŸ¥æ¨™ç±¤åƒç…§å®Œæ•´æ€§\n  SoundboardDebug.test.checkIds()   æª¢æŸ¥ ID å”¯ä¸€æ€§\n  SoundboardDebug.test.all()        åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦ï¼ˆä¸å«æª”æ¡ˆæª¢æŸ¥ï¼‰\n\n%cã€ç‹€æ…‹æª¢è¦–ã€‘%c\n  SoundboardDebug.inspect.state()       æŸ¥çœ‹å®Œæ•´ state ç‰©ä»¶\n  SoundboardDebug.inspect.sound(id)     æŸ¥çœ‹ç‰¹å®šéŸ³æ•ˆï¼ˆå¯ç”¨ ID æˆ–ç´¢å¼•ï¼‰\n  SoundboardDebug.inspect.sounds(page)  åˆ—å‡ºéŸ³æ•ˆï¼ˆåˆ†é ï¼Œæ¯é  20 ç­†ï¼‰\n  SoundboardDebug.inspect.tag(key)      æŸ¥çœ‹ç‰¹å®šæ¨™ç±¤è©³æƒ…\n  SoundboardDebug.inspect.tags()        åˆ—å‡ºæ‰€æœ‰æ¨™ç±¤\n  SoundboardDebug.inspect.favorites()   æŸ¥çœ‹æœ€æ„›åˆ—è¡¨è©³æƒ…\n\n%cã€å…¶ä»–ã€‘%c\n  SoundboardDebug.help()            é¡¯ç¤ºæ­¤èªªæ˜\n  SoundboardDebug.lastTestResult    ä¸Šæ¬¡æª”æ¡ˆæ¸¬è©¦çš„çµæœï¼ˆåŸ·è¡Œ checkFiles å¾Œï¼‰\n\n`,"color: #6aa9ff; font-weight: bold;","","color: #ff9e6a; font-weight: bold;","color: inherit;","color: #ff9e6a; font-weight: bold;","color: inherit;","color: #ff9e6a; font-weight: bold;","color: inherit;","color: #ff9e6a; font-weight: bold;","color: inherit;")},lastTestResult:null,_version:e}})();window.SoundboardDebug=G}()</script></div></body></html>