<!doctype html><html lang="zh-Hant"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="assets/favicon.png" type="image/png"><title>阿萬與動物朋友按鈕</title><style>:root{--bg:#0b0d10;--search:#0b0d1000;--fg:#e9eef5;--muted:#a8b3c7;--card:#141821;--card-2:#212832;--border:#202636;--accent:#6aa9ff;--heart:#ff5a7a;--chip-fg:#0b0d10;--shadow:0 6px 24px rgba(0,0,0,.25);--bg-blend-mode:normal;--bg-opacity:0.25;--control-h:44px;--liquid-hover:rgba(96,150,255,.20)}:root.light{--bg:#f8fafc;--search:#f8fafc00;--fg:#0d1320;--muted:#4b5563;--card:#ffffff;--card-2:#f3f6fb;--border:#e5e7eb;--accent:#2563eb;--heart:#e11d48;--chip-fg:#ffffff;--shadow:0 4px 18px rgba(2,6,23,.08);--bg-blend-mode:normal;--bg-opacity:0.35}*{box-sizing:border-box}body,html{height:100%}body{margin:0;background-color:var(--bg);color:var(--fg);font:medium ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Noto Sans,"Helvetica Neue",Arial;position:relative;z-index:1}body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background-image:url('assets/background-by-jia.avif');background-size:auto 90%;background-repeat:repeat;background-attachment:fixed;mix-blend-mode:var(--bg-blend-mode);opacity:var(--bg-opacity);z-index:-1}a{color:inherit}.wrap{max-width:1100px;margin:0 auto;padding:20px}header{display:flex;align-items:center;flex-wrap:wrap;gap:12px;margin-bottom:14px}header h1{white-space:nowrap;margin-right:auto}h1{font-size:1.4rem;margin:0 8px 0 0;letter-spacing:.5px}.theme-toggle{border:1px solid var(--border);background:var(--card);color:var(--fg);border-radius:10px;padding:8px 12px;cursor:pointer;box-shadow:var(--shadow)}.search-row{display:flex;flex-wrap:wrap;gap:0;align-items:stretch;position:sticky;top:0;background:var(--search);padding:8px 0 12px;z-index:5}.searchbar{flex:1 1 260px;display:flex;align-items:center;gap:6px;background:var(--glass-bg)!important;border:1px solid var(--glass-border)!important;backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);border-radius:12px;padding:6px 8px;box-shadow:var(--shadow);position:relative;height:var(--control-h)}.searchbar input{flex:1;background:0 0;border:0;outline:0;color:var(--fg);font-size:16px;min-width:160px;height:100%;line-height:var(--control-h);padding:0 6px}.chips{display:flex;flex-wrap:wrap;gap:4px;margin-top:4px}.chip{display:inline-flex;align-items:center;gap:4px;border-radius:999px;padding:4px 8px;font-size:12px;color:var(--chip-fg);box-shadow:0 2px 6px rgba(0,0,0,.18)}.chip button{appearance:none;border:0;background:0 0;color:inherit;cursor:pointer;font-size:14px;line-height:1;padding:0 0 0 2px}.searchbar .chip{cursor:pointer}.section-title{margin:18px 0 10px;font-weight:700;letter-spacing:.3px}.grid{display:grid;gap:4px;grid-template-columns:repeat(6,minmax(0,1fr))}@media (max-width:1000px){.grid{grid-template-columns:repeat(5,minmax(0,1fr))}}@media (max-width:800px){.grid{grid-template-columns:repeat(4,minmax(0,1fr))}}@media (max-width:600px){.grid{grid-template-columns:repeat(3,minmax(0,1fr))}}@media (max-width:400px){.grid{grid-template-columns:repeat(2,minmax(0,1fr))}}.sound{background:var(--glass-bg);border:1px solid var(--glass-border);backdrop-filter:saturate(1) blur(8px);-webkit-backdrop-filter:saturate(1) blur(8px);border-radius:12px;padding:8px;box-shadow:var(--shadow);display:flex;flex-direction:column;gap:5px 2px;user-select:none;cursor:pointer;transition:transform .06s ease}.sound:active{transform:scale(.985)}.sound-top{display:flex;align-items:center;gap:4px}.title{font-weight:600;font-size:smaller;flex:1;min-width:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.heart{width:24px;height:24px;border-radius:50%;place-items:center;border:1px solid var(--border);background:var(--card-2);cursor:pointer;flex:0 0 auto}.heart svg{width:16px;height:16px;display:block}.heart[aria-pressed=true] svg path{fill:var(--heart)}.tags{display:flex;flex-wrap:wrap;gap:6px}.tag{border-radius:999px;padding:3px 6px;font-size:small;color:var(--chip-fg);cursor:pointer;white-space:nowrap;box-shadow:0 2px 6px rgba(0,0,0,.16)}.stage{position:fixed;left:0;right:0;bottom:12px;display:flex;flex-wrap:wrap;gap:12px 14px;justify-content:center;pointer-events:none;z-index:40;padding:0 12px}.group{display:inline-flex;gap:8px;align-items:flex-end}.avatar{width:75px;height:75px;border-radius:999px;background:0 0;overflow:hidden;border:2px solid rgba(255,255,255,.8);box-shadow:0 8px 24px rgba(0,0,0,.35);transform-origin:50% 100%}.avatar>img{width:100%;height:100%;object-fit:cover}@keyframes popIn{0%{transform:translateY(20px) scale(.7);opacity:0}100%{transform:translateY(0) scale(1);opacity:1}}@keyframes jitter{0%,100%{transform:translateY(0) rotate(0)}20%{transform:translateY(-2px) rotate(-1deg)}40%{transform:translateY(1px) rotate(1deg)}60%{transform:translateY(-1px) rotate(.6deg)}80%{transform:translateY(1px) rotate(-.6deg)}}@keyframes hopOut{0%{transform:translateY(0);opacity:1}22%{transform:translateY(-12px);opacity:1}100%{transform:translateY(60px);opacity:0}}.pop-in{animation:popIn .28s cubic-bezier(.2,.9,.18,1) both}.jit{animation:jitter .9s ease-in-out infinite}.hop-out{animation:hopOut .5s cubic-bezier(.2,.8,.2,1) forwards}.hidden{display:none}.desc{color:var(--muted);font-size:14px;margin:0 0 6px}.empty{color:var(--muted);padding:12px 0}.row{display:flex;gap:10px;flex-wrap:wrap}.btn{border:1px solid var(--border);background:var(--card);color:var(--fg);border-radius:10px;padding:8px 12px;cursor:pointer}.tabs{display:flex;gap:8px;align-items:center;flex-wrap:wrap}.tab{display:inline-block;padding:6px 16px;font-size:14px;border:1px solid var(--border);border-radius:999px;background:var(--card-2);color:var(--fg);cursor:pointer;transition:background .15s ease,color .15s ease}.tab:hover{background:var(--card)}.tab.active{background:var(--accent);border-color:var(--accent);color:var(--chip-fg)}@media (max-width:600px){header .tabs{margin-top:8px}header .theme-toggle{margin-top:8px}}.section-header{display:flex;align-items:center;justify-content:space-between;margin:14px 0 8px}.section-header .actions{display:flex;gap:8px}.section-header h3{margin:0;font-size:1rem;font-weight:600;letter-spacing:.2px}.small-btn{font-size:12px;padding:4px 8px;border-radius:8px}.tag-list{display:flex;flex-wrap:wrap;gap:6px 8px;margin:8px 0}.tag-list .tag{cursor:pointer}.menu{position:fixed;z-index:9999;min-width:180px;background:var(--glass-bg)!important;border:1px solid var(--glass-border)!important;backdrop-filter:saturate(1.8) blur(12px);-webkit-backdrop-filter:saturate(1.8) blur(12px);border-radius:12px;overflow:hidden}.menu.hidden{display:none}.menu-item{padding:10px 12px;cursor:pointer;border-bottom:1px solid var(--border)}.menu-item:last-child{border-bottom:0}.menu-item:hover{background:var(--liquid-hover)}.toast{position:fixed;left:50%;bottom:80px;transform:translateX(-50%);background:var(--card);border:1px solid var(--border);padding:10px 14px;border-radius:10px;box-shadow:var(--shadow);z-index:70}.toast.hidden{display:none}.glow-persistent{box-shadow:0 0 0 4px rgba(106,169,255,.5),0 0 12px rgba(106,169,255,.75);transition:box-shadow .3s ease}:root{--glass-bg:rgba(20,24,33,.8);--glass-border:rgba(255,255,255,.12)}:root.light{--glass-bg:rgba(255,255,255,.6);--glass-border:rgba(15,23,42,.12)}.glass{background:var(--glass-bg);border:1px solid var(--glass-border);backdrop-filter:blur(3px);-webkit-backdrop-filter:blur(3px);background-clip:padding-box;box-shadow:var(--shadow)}.menu,.searchbar,.sound{background:var(--glass-bg)!important;border-color:var(--glass-border)!important;backdrop-filter:blur(2px);-webkit-backdrop-filter:blur(2px)}header{position:relative}.nav-toggle{display:none;align-items:center;justify-content:center;border:1px solid var(--border);background:var(--card);color:var(--fg);border-radius:10px;padding:8px;cursor:pointer;box-shadow:var(--shadow)}@media (max-width:760px){.nav-toggle{display:inline-flex}header .tabs{display:none;position:absolute;right:0;top:100%;padding:8px;border-radius:12px;gap:6px;flex-direction:column;align-items:stretch;min-width:180px;z-index:30;background:var(--glass-bg);border:1px solid var(--glass-border);backdrop-filter:saturate(1.8) blur(12px);-webkit-backdrop-filter:saturate(1.8) blur(12px);box-shadow:var(--shadow)}body.nav-open header .tabs{display:flex}}body.bg-full{--bg-opacity:1!important}.bg-page{min-height:50vh}.bg-credit{position:fixed;right:16px;bottom:16px;font-size:large;padding:8px 12px;border-radius:10px;font-weight:800;background:var(--glass-bg);border:1px solid var(--glass-border);backdrop-filter:saturate(1.8) blur(10px);-webkit-backdrop-filter:saturate(1.8) blur(10px);box-shadow:var(--shadow);z-index:60}.bg-credit a{text-decoration:underline}#clearBtn.btn{height:var(--control-h);display:inline-flex;align-items:center;justify-content:center;padding:0 14px}.search-row .searchbar{border-top-right-radius:0;border-bottom-right-radius:0;border-right:0!important}.search-row #clearBtn{border-top-left-radius:0;border-bottom-left-radius:0;border-left:1px solid var(--glass-border);background:var(--glass-bg);backdrop-filter:saturate(1.5) blur(8px);-webkit-backdrop-filter:saturate(1.5) blur(8px)}#page-about{background:var(--glass-bg);border:1px solid var(--glass-border);backdrop-filter:saturate(1.8) blur(12px);-webkit-backdrop-filter:saturate(1.8) blur(12px);border-radius:14px;padding:14px 16px;box-shadow:var(--shadow)}header{flex-wrap:nowrap}header h1{white-space:normal;min-width:0;overflow-wrap:anywhere}.search-row{flex-wrap:nowrap}.search-row .searchbar{flex:1 1 auto;min-width:0}.search-row .searchbar input{min-width:0}.search-row #clearBtn{flex:0 0 auto;white-space:nowrap}.drag-ghost{opacity:.6;transform:scale(.98)}.drag-chosen{outline:2px dashed var(--accent)}.dragging{cursor:grabbing}body.sorting #favGrid .card{cursor:grab}</style></head><body><div class="wrap"><header><h1><a href="index.html">阿萬與動物朋友按鈕</a></h1><button id="navToggle" class="nav-toggle" aria-label="打開選單" aria-expanded="false" aria-controls="primaryNav" title="選單"><svg width="22" height="22" viewBox="0 0 24 24" aria-hidden="true"><path d="M3 6h18M3 12h18M3 18h18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg></button><nav id="primaryNav" class="tabs" aria-label="主選單"><button class="tab active" data-page="home">主頁</button> <button class="tab" data-page="bg" id="tab-bg">背景</button> <button class="tab" data-page="about">關於</button> <button id="themeBtn" class="theme-toggle" aria-label="切換主題">電燈開關</button></nav></header><div id="page-home"><div class="search-row"><div class="searchbar" role="search"><svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16a6.471 6.471 0 0 0 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"/></svg> <input id="q" placeholder="搜尋標題或 #標籤（可多個，用空白分隔）" autocomplete="off"><div id="activeChips" class="chips"></div></div><button id="clearBtn" class="btn" aria-label="清除搜尋">清除</button></div><div id="tagList" class="tag-list"></div><div class="section-header"><h3>最愛音效</h3><div class="actions"><button id="sortFavBtn" class="btn small-btn">手動排序</button><button id="doneSortBtn" class="btn small-btn glow-persistent hidden">儲存排序</button><button id="shareFavBtn" class="btn small-btn">分享最愛</button></div></div><div id="favGrid" class="grid"></div><div id="favEmpty" class="empty hidden">還沒有最愛。點音效右上的 ❤️ 加入最愛。</div><div id="receivedSection" class="hidden"><div id="receivedHeader" class="section-header"><h3>收到的列表</h3></div><div id="receivedGrid" class="grid"></div></div><div class="section-header"><h3>全部音效</h3><button id="shuffleBtn" class="btn small-btn">洗牌</button></div><p class="desc">提示：點音效即可播放；右鍵（或行動裝置長按）可分享/下載。</p><div id="grid" class="grid"></div><div id="empty" class="empty hidden">沒有符合搜尋的音效。</div></div><div id="page-game" class="hidden"><p>你怎麼發現的？絕讚施工中。</p></div><div id="page-bg" class="bg-page hidden" aria-labelledby="tab-bg" role="region"><div class="bg-credit"><a href="https://x.com/jiauwu_0730" target="_blank" rel="noopener">背景插畫由 Jia 繪製</a></div></div><div id="page-about" class="hidden"><p>本站由粉肝製作，並非由厭世醫師阿萬官方經營。音效內容皆是粉肝去脈絡式、斷章取義的剪輯，僅供娛樂。最後更新時間：2025/9/25。</p><p>阿萬本家→ <a href="https://x.com/drlifesucks" target="_blank">厭世醫師阿萬X</a>、<a href="https://www.youtube.com/@Dr.lifesucks" target="_blank">厭世醫師阿萬Youtube</a></p><p><a href="https://discord.gg/e6ch4VbRB4" target="_blank">音效板問題回報與建議區</a></p><h2>大德芳名錄</h2><p>感謝53、Kie在DC弄了一堆音效，讓南想到可以做這個網站，並在提出這個想法的一開始就弄了一堆音效過來。還有同樣感謝在原型階段就幫忙收集音效的米糕跟薰薰草。<br>感謝Jia繪製超可愛的背景圖跟收集了很多音效。<br><br>感謝粉肝們收集很多音效，豐富了這個網站（Word筆劃順）：<br>AmBinBong、CZ、HUI、Lococco de suzuran、Nokimi07、Sigh、TENN、Yichen沉沉、🌙🐰月桂葉香包♏🎵、布丁(25:00)、幸福柴柴、青末枝、凌伊LingYi（01）、夏白衫、澐▽米粉 肉干、貓貓雨。 以及其他回報問題、提出建議的粉肝們，你們讓這個網站的功能更完善。</p></div></div><div id="stage" class="stage" aria-hidden="true"></div><div id="menu" class="menu hidden" role="menu" aria-label="音效選單"></div><div id="toast" class="toast hidden" role="status" aria-live="polite"></div><script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.3/Sortable.min.js"></script><script>!function(){function e(e){return e+(e.includes("?")?"&":"?")+"v="+encodeURIComponent("ver2025-09-25-3")}const t={q:document.getElementById("q"),activeChips:document.getElementById("activeChips"),grid:document.getElementById("grid"),favGrid:document.getElementById("favGrid"),empty:document.getElementById("empty"),favEmpty:document.getElementById("favEmpty"),themeBtn:document.getElementById("themeBtn"),stage:document.getElementById("stage"),clearBtn:document.getElementById("clearBtn"),get menu(){return document.getElementById("menu")},get toast(){return document.getElementById("toast")},pageHome:document.getElementById("page-home"),pageGame:document.getElementById("page-game"),pageAbout:document.getElementById("page-about"),pageBg:document.getElementById("page-bg"),navToggle:document.getElementById("navToggle"),get navTabs(){return document.querySelectorAll(".tab")},tagList:document.getElementById("tagList"),receivedSection:document.getElementById("receivedSection"),receivedGrid:document.getElementById("receivedGrid"),receivedHeader:document.getElementById("receivedHeader"),sortFavBtn:document.getElementById("sortFavBtn"),doneSortBtn:document.getElementById("doneSortBtn"),shareFavBtn:document.getElementById("shareFavBtn"),shuffleBtn:document.getElementById("shuffleBtn")},n={tags:{},tagList:[],sounds:[],favorites:JSON.parse(localStorage.getItem("favorites")||"[]"),favSet:new Set,queryText:"",queryTags:new Set,contextTimer:null,page:"home",receivedList:[],toastTimer:null,usedTagList:[],isSorting:!1,sortable:null,highlightedCardId:""};n.favSet=new Set(n.favorites);const a={el(e,t={},n=[]){const a=document.createElement(e);return Object.entries(t).forEach(([e,t])=>{"class"===e?a.className=t:"style"===e?Object.assign(a.style,t):e.startsWith("on")&&"function"==typeof t?a.addEventListener(e.substring(2),t):null!=t&&a.setAttribute(e,t)}),(Array.isArray(n)?n:[n]).filter(Boolean).forEach(e=>{"string"==typeof e?a.appendChild(document.createTextNode(e)):a.appendChild(e)}),a},svgHeart(){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");return e.setAttribute("viewBox","0 0 24 24"),e.innerHTML='<path d="M12 21s-6.716-4.438-9.428-7.15C.59 11.868.59 8.608 2.57 6.627 4.55 4.647 7.81 4.647 9.79 6.627L12 8.838l2.21-2.21c1.98-1.98 5.24-1.98 7.22 0 1.98 1.98 1.98 5.24 0 7.223C18.716 16.562 12 21 12 21z" fill="none" stroke="currentColor" stroke-width="1.5"/>',e}},s={slug:e=>e.normalize("NFKC").trim().toLowerCase(),byId:e=>document.getElementById(e),saveFav(){localStorage.setItem("favorites",JSON.stringify(n.favorites))},inFav:e=>n.favSet.has(e),download(e,t){const n=document.createElement("a");n.href=e,n.download=t||"",document.body.appendChild(n),n.click(),n.remove()},parseQuery(){const e=n.queryText.trim(),t=e.length?e.split(/\s+/):[],a=new Set([...n.queryTags]),o=[];for(const e of t)e.startsWith("#")?a.add(s.slug(e.slice(1))):o.push(s.slug(e));return{terms:o,tags:a}},match(e,t,n){for(const t of n)if(!e.tags.some(e=>s.slug(e)===t))return!1;for(const n of t){const t=e.title.toLowerCase().includes(n.toLowerCase()),a=e.tags.some(e=>e.toLowerCase().includes(n.toLowerCase()));if(!t&&!a)return!1}return!0}};function o(){const{terms:e,tags:t}=s.parseQuery(),n=new URLSearchParams(window.location.search);return e.length?n.set("q",e.join(" ")):n.delete("q"),t.size?n.set("tags",[...t].join(",")):n.delete("tags"),n.delete("sound"),n}function i(e=!1){const t=o(),a=new URLSearchParams(location.search);a.has("list")&&t.set("list",a.get("list")),a.has("sound")&&t.set("sound",a.get("sound")),n.page&&"home"!==n.page?t.set("page",n.page):t.delete("page");const s=t.toString(),i=`${location.pathname}${s?"?"+s:""}`;(e?history.pushState:history.replaceState).call(history,null,"",i)}function r(){const e=new URLSearchParams(location.search),a=e.get("q")||"",o=e.get("tags")||"";n.queryTags.clear();const i=o?o.split(",").map(e=>s.slug(e)).filter(Boolean):[];for(const e of i)n.queryTags.add(e);n.queryText=a;const r=i.map(e=>"#"+(n.tags[e]?.name||e));t.q.value=[a,...r].filter(Boolean).join(" ");const d=e.get("page");n.page="game"===d||"about"===d||"bg"===d?d:"home";const c=e.get("list");n.receivedList=c?c.split(",").filter(Boolean):[]}function d(){const e=new URLSearchParams(location.search).get("sound");if(!e)return;const t=s.byId("snd-"+e);if(t){if(t.scrollIntoView({behavior:"smooth",block:"center"}),n.highlightedCardId){const e=s.byId("snd-"+n.highlightedCardId);e&&e.classList.remove("glow-persistent")}n.highlightedCardId=e,t.classList.add("glow-persistent")}}function c(e){n.page=e,t.pageHome.classList.add("hidden"),t.pageGame.classList.add("hidden"),t.pageAbout.classList.add("hidden"),t.pageBg&&t.pageBg.classList.add("hidden"),"home"===e?t.pageHome.classList.remove("hidden"):"game"===e?t.pageGame.classList.remove("hidden"):"about"===e?t.pageAbout.classList.remove("hidden"):"bg"===e&&t.pageBg&&t.pageBg.classList.remove("hidden"),t.navTabs.forEach(t=>{t.getAttribute("data-page")===e?t.classList.add("active"):t.classList.remove("active")}),document.body.classList.toggle("bg-full","bg"===e||"about"===e),document.body.classList.remove("nav-open"),t.navToggle&&t.navToggle.setAttribute("aria-expanded","false"),i(!0)}function l(e){return navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(e).catch(()=>g(e)):g(e)}function g(e){const t=a.el("textarea",{style:{position:"fixed",left:"-9999px",top:"0"}},e);document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch(e){}return t.remove(),Promise.resolve()}function u(e,a=3e3){const s=t.toast;s&&(n.toastTimer&&(clearTimeout(n.toastTimer),n.toastTimer=null),s.textContent=e,s.classList.remove("hidden"),a>0&&(n.toastTimer=setTimeout(()=>{s.classList.add("hidden"),n.toastTimer=null},a)))}function m(e,n,o){const i=t.menu;if(!i)return;i.innerHTML="";const r=a.el("div",{class:"menu-item",role:"menuitem",tabindex:"0"},"分享網址");r.addEventListener("click",async()=>{const t=`${window.location.origin}/soundboard/?sound=${e.id}`;await l(t),v(),u("已複製分享連結");s.byId("snd-"+e.id)});const d=a.el("div",{class:"menu-item",role:"menuitem",tabindex:"0"},"下載音檔");d.addEventListener("click",()=>{v(),s.download(e.src,e.file)}),i.append(r,d),i.classList.remove("hidden"),requestAnimationFrame(()=>function(e,n){const a=t.menu;if(!a)return;const s=6,o=a.offsetWidth||180,i=a.offsetHeight||100,r=window.innerWidth,d=window.innerHeight,c=Math.min(Math.max(0,e),r-o-s),l=Math.min(Math.max(0,n),d-i-s);a.style.left=c+"px",a.style.top=l+"px"}(n,o))}function v(){const e=t.menu;e&&(e.classList.add("hidden"),e.innerHTML="")}function f(e){document.documentElement.classList.toggle("light","light"===e)}window.addEventListener("popstate",()=>{r(),T(),d()}),document.addEventListener("click",e=>{const n=t.menu;!n||n.classList.contains("hidden")||n.contains(e.target)||v()}),document.addEventListener("keydown",e=>{"Escape"===e.key&&v()}),window.addEventListener("resize",v);f(localStorage.getItem("theme")||(matchMedia("(prefers-color-scheme:light)").matches?"light":"dark")),t.themeBtn.addEventListener("click",()=>{const e=document.documentElement.classList.contains("light")?"dark":"light";"dark"==e&&function(e){const t=n.sounds.find(t=>t.id===e);if(!t)return;const a=new Audio(t.src);a.preload="auto",a.addEventListener("play",()=>p(t,a)),a.addEventListener("ended",()=>y(t,a)),a.play().catch(()=>{})}("oNTWqg"),localStorage.setItem("theme",e),f(e)});const h=new Set;function p(o,i){const r=o.tags.map(e=>n.tags[s.slug(e)]).filter(e=>e&&"streamer"===e.role&&e.avatar);if(0===r.length)return;const d=a.el("div",{class:"group"});h.add(d),r.forEach((t,n)=>{const s=a.el("div",{class:"avatar pop-in jit",style:{animationDelay:60*n+"ms"}},[a.el("img",{src:e(t.avatar),alt:t.name})]);d.appendChild(s)}),t.stage.appendChild(d),i.__group=d}function y(e,t){const n=t.__group;if(!n)return;Array.from(n.children).forEach((e,t)=>{e.classList.remove("jit"),setTimeout(()=>{e.classList.add("hop-out"),e.addEventListener("animationend",()=>{e.remove(),0===n.childElementCount&&(n.remove(),h.delete(n))},{once:!0})},90*t)})}const L="favorites",E="favorites_version",S=/^[A-Za-z0-9_-]{6}$/;function b(e){if(!e)return[];try{const t=JSON.parse(e);if(Array.isArray(t))return t.map(String);if(t&&"object"==typeof t)return Object.keys(t).filter(e=>!!t[e]).map(String)}catch(t){if("string"==typeof e)return e.split(/[,\s]+/).map(e=>e.trim()).filter(Boolean)}return[]}function w(e){if(!e)return"";let t=String(e);t=t.split("?")[0],t=t.replace(/^\.?\//,"");try{t=decodeURIComponent(t)}catch{}return t}function B(e){try{const t=localStorage.getItem(L);if(!function(e){const t=b(e);return 0!==t.length&&!t.every(e=>S.test(e))}(t))return void localStorage.setItem(E,"2");const a=b(t),{exact:s,lower:o}=function(e){const t=new Map,n=new Map;return e.forEach(e=>{const a=w(e.file),s=a.split("/").pop(),o=e.id||s;[a,s,"sounds/"+a,"sounds/"+s].forEach(e=>{t.set(e,o),n.set(e.toLowerCase(),o)})}),{exact:t,lower:n}}(e),i=[],r=new Set,d=[];a.forEach(e=>{const t=w(e),n=t.split("/").pop(),a=[t,t.replace(/^sounds\//,""),n,"sounds/"+t,"sounds/"+n];let c=null;for(const e of a)if(c=s.get(e)||o.get(e.toLowerCase()),c)break;c?r.has(c)||(r.add(c),i.push(c)):d.push(e)}),localStorage.setItem("favorites_legacy_backup",t),localStorage.setItem(L,JSON.stringify(i)),localStorage.setItem(E,"2"),n.favorites=i,n.favSet=new Set(i),u(`已升級最愛格式，共 ${i.length} 筆${d.length?`；未匹配 ${d.length} 筆`:""}。`),console.info("[favorites migration] done:",{converted:i.length,missing:d})}catch(e){console.warn("[favorites migration] error:",e)}}function T(){const{terms:e,tags:o}=s.parseQuery(),r=n.sounds.filter(t=>s.match(t,e,o)),d=n.receivedList.map(e=>n.sounds.find(t=>t.id===e)).filter(Boolean),c=new Map(n.sounds.map(e=>[e.id,e])),l=new Set(r.map(e=>e.id)),g=n.favorites.map(e=>c.get(e)).filter(e=>e&&l.has(e.id)),u=d.filter(e=>r.includes(e)&&!n.favSet.has(e.id)),m=r.filter(e=>!n.favSet.has(e.id)&&!u.includes(e));n.isSorting||I(t.favGrid,g,{inFav:!0}),I(t.receivedGrid,u),I(t.grid,m),t.favEmpty.classList.toggle("hidden",g.length>0),t.empty.classList.toggle("hidden",r.length>0),u.length>0?t.receivedSection&&t.receivedSection.classList.remove("hidden"):t.receivedSection&&t.receivedSection.classList.add("hidden"),function(){t.activeChips.innerHTML="";for(const e of n.queryTags){const s=n.tags[e],o=s?.color||"#94a3b8",r=a.el("span",{class:"chip",style:{background:o},onclick:()=>{n.queryTags.delete(e),T(),i(!0)}},[`#${s?.name||e}`,a.el("button",{title:"移除",onclick:()=>{n.queryTags.delete(e),T(),i(!0)}},"×")]);t.activeChips.appendChild(r)}}()}function I(e,t,n={inFav:!1}){e.innerHTML="";for(const a of t)e.appendChild(k(a,n))}function k(e,t={inFav:!1}){const o=a.el("button",{class:"heart","aria-pressed":String(s.inFav(e.id)),"aria-label":"加入/移除最愛",onclick:t=>{t.stopPropagation(),function(e,t){n.favSet.has(e)?n.favorites=n.favorites.filter(t=>t!==e):n.favorites.push(e);n.favSet=new Set(n.favorites),s.saveFav(),t.setAttribute("aria-pressed",String(n.favSet.has(e))),T()}(e.id,o)}},a.svgHeart()),i=a.el("div",{class:"tags"});for(const t of e.tags){const e=s.slug(t),o=n.tags[e],r=o?.color||"#94a3b8",d=a.el("span",{class:"tag",style:{background:r}},t);d.addEventListener("click",t=>{t.stopPropagation(),C(e)}),i.appendChild(d)}const r=a.el("div",{id:"snd-"+e.id,"data-id":e.id,class:"sound",role:"button",tabindex:"0","aria-label":`播放音效：${e.title}`},[a.el("div",{class:"sound-top"},[a.el("div",{class:"title",title:e.title},e.title),o]),i]),d=async()=>{const t=new Audio(e.src);t.preload="auto",t.addEventListener("play",()=>p(e,t)),t.addEventListener("ended",()=>y(0,t));try{await t.play()}catch(e){console.error(e)}};n.isSorting&&t.inFav||r.addEventListener("click",d),n.isSorting&&t.inFav||r.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),d())}),n.isSorting&&t.inFav||r.addEventListener("contextmenu",t=>{t.preventDefault(),v(),m(e,t.clientX,t.clientY)});const c=()=>{clearTimeout(n.contextTimer)};return n.isSorting&&t.inFav||r.addEventListener("pointerdown",t=>{clearTimeout(n.contextTimer);const{clientX:a,clientY:s}=t;n.contextTimer=setTimeout(()=>{v(),m(e,a||window.innerWidth/2,s||window.innerHeight/2)},650)}),n.isSorting&&t.inFav||r.addEventListener("pointerup",c),n.isSorting&&t.inFav||r.addEventListener("pointerleave",c),r.addEventListener("pointercancel",c),r}function C(e){n.queryTags.add(e),T(),i(!0)}function x(){t.q.addEventListener("input",()=>{n.queryText=t.q.value;const e=t.q.value,a=e.split(/\s+/).pop()||"",s=a.startsWith("#")?a.slice(1).toLowerCase():e.trim().toLowerCase();s?n.tagList.filter(e=>e.name.toLowerCase().includes(s)||e.key.toLowerCase().includes(s)):n.tagList.slice(0,8);T(),i(!1)}),t.clearBtn.addEventListener("click",()=>{t.q.value="",n.queryText="",n.queryTags.clear(),T(),i(!0)}),t.navTabs.forEach(e=>{e.addEventListener("click",()=>{c(e.getAttribute("data-page")||"home")})}),t.navToggle&&t.navToggle.addEventListener("click",()=>{const e=!document.body.classList.contains("nav-open");document.body.classList.toggle("nav-open",e),t.navToggle.setAttribute("aria-expanded",String(e))}),document.addEventListener("click",e=>{if(document.body.classList.contains("nav-open")){const n=document.querySelector("header");n&&!n.contains(e.target)&&(document.body.classList.remove("nav-open"),t.navToggle&&t.navToggle.setAttribute("aria-expanded","false"))}}),t.navTabs.forEach(e=>e.addEventListener("click",()=>{document.body.classList.remove("nav-open"),t.navToggle&&t.navToggle.setAttribute("aria-expanded","false")})),t.shuffleBtn&&t.shuffleBtn.addEventListener("click",()=>{const e=[],t=[];n.sounds.forEach((a,s)=>{n.favSet.has(a.id)||(e.push(a),t.push(s))}),function(e,t=Math.random){for(let n=e.length-1;n>0;n--){const a=Math.floor(t()*(n+1));[e[n],e[a]]=[e[a],e[n]]}}(e),t.forEach((t,a)=>{n.sounds[t]=e[a]}),T()}),t.sortFavBtn&&t.doneSortBtn&&(t.sortFavBtn.addEventListener("click",()=>{n.isSorting=!0,document.body.classList.add("sorting"),t.sortFavBtn.classList.add("hidden"),t.doneSortBtn.classList.remove("hidden");const{terms:e,tags:a}=s.parseQuery(),o=new Map(n.sounds.map(e=>[e.id,e])),i=new Set(n.sounds.filter(t=>s.match(t,e,a)).map(e=>e.id)),r=n.favorites.map(e=>o.get(e)).filter(e=>e&&i.has(e.id));I(t.favGrid,r,{inFav:!0}),"undefined"!=typeof Sortable?n.sortable=Sortable.create(t.favGrid,{dataIdAttr:"data-id",animation:150,delay:150,delayOnTouchOnly:!0,ghostClass:"drag-ghost",chosenClass:"drag-chosen",dragClass:"dragging",filter:".heart",preventOnFilter:!1}):console.warn("SortableJS 未載入")}),t.doneSortBtn.addEventListener("click",()=>{const e=Array.from(t.favGrid.children).map(e=>e.getAttribute("data-id")).filter(Boolean);if(e.length){const t=n.favorites.filter(t=>!e.includes(t));n.favorites=e.concat(t),n.favSet=new Set(n.favorites),s.saveFav(),u("已儲存最愛排序")}n.sortable&&(n.sortable.destroy(),n.sortable=null),n.isSorting=!1,document.body.classList.remove("sorting"),t.doneSortBtn.classList.add("hidden"),t.sortFavBtn.classList.remove("hidden"),T()})),t.shareFavBtn&&t.shareFavBtn.addEventListener("click",async()=>{const e=[...n.favorites];if(0===e.length)return void u("沒有最愛可分享");const t=function(e){const t=o();e&&e.length?t.set("list",e.join(",")):t.delete("list"),t.delete("sound");const n=t.toString();return`${location.origin}${location.pathname}${n?"?"+n:""}`}(e);await l(t),u("已複製分享最愛列表連結")})}(async function(){const[t,a]=await Promise.all([fetch(e("config/tags.json"),{cache:"no-store"}).then(e=>e.json()),fetch(e("config/sounds.json"),{cache:"no-store"}).then(e=>e.json())]);B(a),n.tags={},n.tagList=t.map(e=>({key:s.slug(e.key),name:e.name,color:e.color,role:e.role,avatar:e.avatar}));for(const e of n.tagList)n.tags[s.slug(e.key)]=e;n.sounds=a.map(t=>({id:t.id||t.file.replace(/^.*[\\\/]/,""),src:e(`sounds/${t.file}`),file:t.file,title:t.title,tags:t.tags.slice()}));const o=new Set;n.sounds.forEach(e=>e.tags.forEach(e=>o.add(s.slug(e)))),n.usedTagList=n.tagList.filter(e=>o.has(e.key))})().then(()=>{r(),function(){const e=t.tagList;e&&(e.innerHTML="",n.usedTagList.forEach(t=>{const n=a.el("span",{class:"tag",style:{background:t.color||"#94a3b8"}},t.name);n.addEventListener("click",()=>{C(t.key)}),e.appendChild(n)}))}(),c(n.page),T(),d(),x()}).catch(e=>{console.error(e),t.grid.innerHTML='<div class="empty">載入設定檔失敗，請確認 <code>config/</code> 路徑是否正確。</div>'})}()</script></body></html>